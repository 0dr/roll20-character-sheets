<div class="sheet-main">
	
	<!-- Game Name, roll toggles, and tab switching -->
	<div class='sheet-topgrid'> 
		
		<a href="https://ibb.co/KqnVCkB"><img src="https://i.ibb.co/yy2gL1K/red-giant-logo.png" alt="red-giant-logo" border="0"></a>
		
		
		<span> </span>
		
		<input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" />
		
		<button type="action" name="act_roll_state_disadvantage" class="sheet-radio-roll-state  sheet-radio-roll-state-disadvantage"> Dis
		</button>
		
		<span> </span>
		
		<button type="action" name="act_roll_state_flat" class="sheet-radio-roll-state  sheet-radio-roll-state-flat"> -
		</button>
		
		<span> </span>
		
		<button type="action" name="act_roll_state_advantage" class="sheet-radio-roll-state  sheet-radio-roll-state-advantage"> Adv
		</button>
		
		<span> </span>
		
		<label class="sheet-big-label" > Roll Mod </label>
		
		<span> </span>
		
		<input name="attr_roll_mod" class="sheet-stat-inputs" type="number" value="0" /> 
		
		<span> </span>
		
		<button type="action" name="act_pc" class="sheet-tabbutton" >PC</button> 
		<span> </span> 
		<button type="action" name="act_npc" class="sheet-tabbutton" >NPC</button>
		
	
	</div>
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
	<!-- line 1 of stats -->
	<div class='sheet-stat1'> 
	
		<span> </span>
		
		<label class="sheet-regular-label" title="STR" > Strength </label>
		<select name="attr_strength" class="sheet-die-dropdowns">
            <option value="4">D4</option><option value="6">D6</option><option value="8">D8</option><option value="10">D10</option><option value="12">D12</option>
        </select>
		
		<label class="sheet-regular-label" title="RFX" > Reflex </label>
		<select name="attr_reflex" class="sheet-die-dropdowns">
            <option value="4">D4</option><option value="6">D6</option><option value="8">D8</option><option value="10">D10</option><option value="12">D12</option>
        </select>
		
		<label class="sheet-big-label-title" > DEFENSE </label>
		
		<!-- repeated here for hiding to work -->
		<input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" />
		
		<button type="roll" name="roll_sanity_check" class="sheet-statrollbutton disadvantage" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=Mind}} {{attribute2=Sanity}} {{die1=D@{mind}}} {{die2=@{sanity}}} {{mod=@{roll_mod}}} {{result=[[2D@{mind}kl1+@{sanity} + @{roll_mod}]]}}" >Sanity! </button> 
		
		<button type="roll" name="roll_sanity_check" class="sheet-statrollbutton flat" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=Mind}} {{attribute2=Sanity}} {{die1=D@{mind}}} {{die2=@{sanity}}} {{mod=@{roll_mod}}} {{result=[[1D@{mind}+@{sanity} + @{roll_mod}]]}}" >Sanity! </button> 
		
		<button type="roll" name="roll_sanity_check" class="sheet-statrollbutton advantage" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=Mind}} {{attribute2=Sanity}} {{die1=D@{mind}}} {{die2=@{sanity}}} {{mod=@{roll_mod}}} {{result=[[2D@{mind}k1+@{sanity} + @{roll_mod}]]}}" >Sanity! </button> 
		
		<label class="sheet-regular-label" > Sanity </label>
		
		<input name="attr_sanity" class="sheet-stat-inputs" type="number" value="0" />
		
		<label class="sheet-regular-label" > / </label>
		
		<input name="attr_sanity_max" class="sheet-stat-inputs" type="number" value="0" />
		
	
	</div>
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
	
	<!-- line 2 of stats -->
	<div class='sheet-stat2'> 
	
		<span> </span>
		
		<label class="sheet-regular-label" title="MND" > Mind </label>
		<select name="attr_mind" class="sheet-die-dropdowns">
            <option value="4">D4</option><option value="6">D6</option><option value="8">D8</option><option value="10">D10</option><option value="12">D12</option>
        </select>
		
		<label class="sheet-regular-label" title="CHA" > Charm </label>
		<select name="attr_charm" class="sheet-die-dropdowns">
            <option value="4">D4</option><option value="6">D6</option><option value="8">D8</option><option value="10">D10</option><option value="12">D12</option>
        </select>
		
		<label class="sheet-regular-label" > Health </label>
		
		<input name="attr_health" class="sheet-stat-inputs" type="number" value="0" />
		
		<label class="sheet-regular-label" > / </label>
		
		<input name="attr_health_max" class="sheet-stat-inputs" type="number" value="0" />
		
		<label class="sheet-regular-label" > Spirit </label>
		
		<input name="attr_spirit" class="sheet-stat-inputs" type="number" value="0" />
		
		<label class="sheet-regular-label" > / </label>
		
		<input name="attr_spirit_max" class="sheet-stat-inputs" type="number" value="0" />
		
	
	</div>
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
	
	<!-- line 3 of stats -->
	<div class='sheet-stat3'> 
	
		<label class="sheet-regular-label"  > Name </label>
		<input name="attr_character_name" class="sheet-char-inputs" type="text"/>
		<span> </span>
		
		<input type="hidden" name="attr_attribute1die" value="">
		<select name="attr_attribute1name" class="sheet-attribute-dropdowns">
            <option value="Strength">Strength</option><option value="Reflex">Reflex</option><option value="Mind">Mind</option><option value="Charm">Charm</option>
        </select>
		
		<label class="sheet-regular-label" > + </label>
		
		<input type="hidden" name="attr_attribute2die" value="">
		<select name="attr_attribute2name" class="sheet-attribute-dropdowns">
            <option value="Strength">Strength</option><option value="Reflex">Reflex</option><option value="Mind">Mind</option><option value="Charm">Charm</option>
        </select>
		
		<!-- repeated here for hiding to work -->
		<input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" />
		
		<button type="roll" name="roll_attribute_check" class="sheet-statrollbuttonshort disadvantage" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=@{attribute1name}}} {{attribute2=@{attribute2name}}} {{die1=D@{attribute1die}}} {{die2=D@{attribute2die}}} {{mod=@{roll_mod}}} {{result=[[2D@{attribute1die}kl1+2D@{attribute2die}kl1 + @{roll_mod}]]}}" >Roll!</button> 
		
		<button type="roll" name="roll_attribute_check" class="sheet-statrollbuttonshort flat" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=@{attribute1name}}} {{attribute2=@{attribute2name}}} {{die1=D@{attribute1die}}} {{die2=D@{attribute2die}}} {{mod=@{roll_mod}}} {{result=[[1D@{attribute1die}+1D@{attribute2die} + @{roll_mod}]]}}" >Roll!</button> 
		
		<button type="roll" name="roll_attribute_check" class="sheet-statrollbuttonshort advantage" value="&{template:attribute} {{charname=@{character_name}}} {{attribute1=@{attribute1name}}} {{attribute2=@{attribute2name}}} {{die1=D@{attribute1die}}} {{die2=D@{attribute2die}}} {{mod=@{roll_mod}}} {{result=[[2D@{attribute1die}k1+2D@{attribute2die}k1 + @{roll_mod}]]}}" >Roll!</button>
		
		
		<label class="sheet-regular-label"  > Look </label>
		<input name="attr_look" class="sheet-char-inputs-long" type="text"/>
		
	
	</div>
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
	<!-- To switch tabs -->
	
	<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='pc'  />
	
	<!-- Player Character sheet -->
	<div class='sheet-main-pc'>
		
		<!-- Player Character sheet - Left Column -->
		<div class='sheet-main-pc-left'>
			
			<!--Attributes -->
			<div class='sheet-attributes'>
			
				<label class="sheet-left-label-1"  > ATTRIBUTES </label>
				
				<label class="sheet-left-label"  > Personality </label>
				<input name="attr_personality" class="sheet-char-inputs-long" type="text"/>
				
				<label class="sheet-left-label"  > Flaw </label>
				<input name="attr_flaw" class="sheet-char-inputs-long" type="text"/>
				
				<label class="sheet-left-label"  > Past </label>
				<input name="attr_past" class="sheet-char-inputs-long" type="text"/>
				
				<label class="sheet-left-label"  > Misfortune </label>
				<input name="attr_misfortune" class="sheet-char-inputs-long" type="text"/>
				
			
			</div>
			
			<div class="col" style="width: 100%; height: 10px;"></div>
			
			<!--Useables - Joss, Rations, & Item Slots -->
			<div class='sheet-useables'>
				
				<label class="sheet-regular-label-left" > Joss </label>
		
				<input name="attr_joss" class="sheet-useable-inputs-long" type="number" value="0" />
				
				<span> </span>
				
				<label class="sheet-regular-label-left" > Rations </label>
		
				<input name="attr_rations" class="sheet-useable-inputs" type="number" value="2" />
			
				<span> </span>
				
				<label class="sheet-regular-label-left" > Item Slots </label>
		
				<input name="attr_itemslots" class="sheet-useable-inputs" type="number" value="0" />
				
				<label class="sheet-regular-label" > / </label>
				
				<input name="attr_itemslots_max" class="sheet-useable-inputs" type="number" value="0" />	
			
			</div>
			
			<div class="col" style="width: 100%; height: 10px;"></div>
			
			<!--Armor -->
			<div class='sheet-armor'>
				
				<div class='sheet-armortitle'>
					
					<label class="sheet-left-label-1"  > ARMOR </label>
					
					<label class="sheet-big-label-table" > ITEM </label>
					<label class="sheet-big-label-table" > DEFENSE </label>
					<label class="sheet-big-label-table" > SIZE </label>
				
				</div>
				
				<div class='sheet-armordetails'>
					
					<fieldset class="repeating_armor">
						<div class="sheet-armor-row">
							<input name="attr_armorname" class="sheet-armor-inputs" type="text"/>
							<span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span> 
							<input name="attr_armordefense" class="sheet-useable-inputs" type="number" value="0" />
							<span> &nbsp; &nbsp; &nbsp; &nbsp; </span> 
							<input name="attr_armorsize" class="sheet-useable-inputs" type="number" value="1" />
							<div class="col" style="width: 100%; height: 7px;"></div>
						</div>
					</fieldset>
				
				</div>
				
			
			</div>
			
			
			
			
			
		
		</div>
		
		
		<!-- Player Character sheet - Right Column -->
		<div class='sheet-main-pc-right'>
		
			<!--Archetype -->
			<div class='sheet-archetype'>
			
				<div class='sheet-archetypename'>
			
					<label class="sheet-left-label-big"  > ARCHETYPE </label>
					<input name="attr_archetype" class="sheet-char-inputs-title" type="text"/>
					
				</div>
				
				<label class="sheet-left-label"  > Skill 1: </label>
				<div class="sheet-auto-expand attribute-width">
					<span name="attr_skill1"></span>
					<textarea spellcheck="false" name="attr_skill1"></textarea>
				</div>
				
				<label class="sheet-left-label"  > Skill 2: </label>
				<div class="sheet-auto-expand attribute-width">
					<span name="attr_skill2"></span>
					<textarea spellcheck="false" name="attr_skill2"></textarea>
				</div>
				
				<label class="sheet-left-label"  > Skill 3: </label>
				<div class="sheet-auto-expand attribute-width">
					<span name="attr_skill3"></span>
					<textarea spellcheck="false" name="attr_skill3"></textarea>
				</div>
				
			
			</div>
			
			
			<!--Exchanges -->
			<div class='sheet-exchanges'>
				
				<label class="sheet-left-label-1"  > EXCHANGES </label>
				
				<fieldset class="repeating_exchanges">
					<div class="sheet-exchanges-row">
						<div class="sheet-auto-expand red-width" >
							<span name="attr_exchangename"></span>
							<textarea spellcheck="false" name="attr_exchangename"></textarea>
						</div>
						<span> &nbsp; </span> 
						<div class="sheet-auto-expand exchange-width" >
							<span name="attr_exchangeability"></span>
							<textarea spellcheck="false" name="attr_exchangeability"></textarea>
						</div>
						<div class="col" style="width: 100%; height: 4px;"></div>
						<label class="sheet-left-label"  > however </label>
						<span> &nbsp; </span> 
						<div class="sheet-auto-expand exchangelong-width">
							<span name="attr_exchangedrawback"></span>
							<textarea spellcheck="false" name="attr_exchangedrawback"></textarea>
						</div>
						<div class="col" style="width: 100%; height: 7px;"></div>
					</div>
				</fieldset>
				
				
			</div>
			
			<div class="col" style="width: 100%; height: 7px;"></div>
			
			<!--Curses -->
			<div class='sheet-curses'>
				
				<label class="sheet-left-label-1"  > CURSES </label>
				
				<fieldset class="repeating_curses">
					<div class="sheet-curses-row">
						<div class="sheet-auto-expand curse-width" >
							<span name="attr_curse"></span>
							<textarea spellcheck="false" name="attr_curse"></textarea>
						</div>
						<div class="col" style="width: 100%; height: 7px;"></div>
					</div>
				</fieldset>
				
				
			</div>
			
			
			
			
			
			
			
			
		
		</div>
		
	
	</div>
	
	<!-- Non-Player Character sheet -->
	<div class='sheet-main-npc'>
		
		
		
		
	
	</div>
	
	
	
</div>



<rolltemplate class="sheet-rolltemplate-attribute">
    <div class="sheet-attribute-container">
        <div class="sheet-attribute-roll-header">
            <br> {{charname}}  &nbsp;
			<span class="attribute-roll-result">
				&nbsp; {{result}}<BR>
				
			</span>
        </div>
        <div class="sheet-attribute-type">
            {{attribute1}} {{die1}} + {{attribute2}} {{die2}} + {{mod}}
        </div>
    </div>
</rolltemplate>




<script type="text/worker">
	//Buttons for Tabs
    const buttonlist = ["pc","npc"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button,
            });
        });
    });
	
	const rollStateRadioValues = ["advantage","flat","disadvantage"];
  rollStateRadioValues.forEach(function(value) {
    on(`clicked:roll_state_${value}`, function() {
      setAttrs({
        ["rollstate"]: value
      });
    });
  });
   
  
  // trigger when the sheet is opened for the first time in a session or statname changes
on('sheet:opened change:attribute1name', () => {
    getAttrs(['attribute1name','strength','reflex','mind','charm','attribute1die'], (values) => {
        // Based on attribute1name, set the correct variable value for attribute1die
        const attribute1name = values.attribute1name.trim();
		let attribute1dienew = values.attribute1die || 0;
		
		if (attribute1name === "Strength") {
	
			attribute1dienew = values.strength || 0;;
		}
		else if (attribute1name === "Reflex") {
	
			attribute1dienew = values.reflex || 0;;
		}
		else if (attribute1name === "Mind") {
	
			attribute1dienew = values.mind || 0;;
		}
		else if (attribute1name === "Charm") {
	
			attribute1dienew = values.charm || 0;;
		}
		
		setAttrs({
			attribute1die: attribute1dienew.toString()
		});
		
		
    });
});


on('sheet:opened change:attribute2name', () => {
    getAttrs(['attribute2name','strength','reflex','mind','charm','attribute2die'], (values) => {
        // Based on attribute2name, set the correct variable value for attribute2die
        const attribute2name = values.attribute2name.trim();
		let attribute2dienew = values.attribute2die || 0;
		
		if (attribute2name === "Strength") {
	
			attribute2dienew = values.strength || 0;;
		}
		else if (attribute2name === "Reflex") {
	
			attribute2dienew = values.reflex || 0;;
		}
		else if (attribute2name === "Mind") {
	
			attribute2dienew = values.mind || 0;;
		}
		else if (attribute2name === "Charm") {
	
			attribute2dienew = values.charm || 0;;
		}
		
		setAttrs({
			attribute2die: attribute2dienew.toString()
		});
		
		
    });
});



	
	
</script>
