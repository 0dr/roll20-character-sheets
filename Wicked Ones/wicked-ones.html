<input type="hidden" name="attr_calling-settings" class="calling-settings"/>
<div class="sheet-main">
  <div class="sheet-left">
    <div class="sheet-details">
      <span data-i18n="name" class="namelabel">Name</span>
      <input type="text" name="attr_character_name" class="name" size="12"/>
      <span data-i18n="race-look" class="looklabel">Race & Look</span>
      <input type="text" name="attr_look" class="look" size="12"/>
      <span data-i18n="dark-impulse" class="impulselabel">Dark Impulse</span>
      <input type="text" name="attr_impulse" class="impulse" size="12"/>
      <span data-i18n="revelry" class="revelrylabel">Revelry</span>
      <input type="text" name="attr_revelry" class="revelry" size="12"/>
      <span data-i18n-list="impulse-list">
        <input type="hidden" name="attr_impulse" class="suggested" value=""/>
        <button type="action" name="act_impulse-bigmouth" class="suggestion" data-i18n="bigmouth" data-i18n-list-item="bigmouth">Bigmouth</button>
        <button type="action" name="act_impulse-cruel" class="suggestion" data-i18n="cruel" data-i18n-list-item="cruel">Cruel</button>
        <button type="action" name="act_impulse-deranged" class="suggestion" data-i18n="deranged" data-i18n-list-item="deranged">Deranged</button>
        <button type="action" name="act_impulse-fickle" class="suggestion" data-i18n="fickle" data-i18n-list-item="fickle">Fickle</button>
        <button type="action" name="act_impulse-obsessed" class="suggestion" data-i18n="obsessed" data-i18n-list-item="obsessed">Obsessed</button>
        <button type="action" name="act_impulse-paranoid" class="suggestion" data-i18n="paranoid" data-i18n-list-item="paranoid">Paranoid</button>
        <button type="action" name="act_impulse-reckless" class="suggestion" data-i18n="reckless" data-i18n-list-item="reckless">Reckless</button>
        <button type="action" name="act_impulse-vengeful" class="suggestion" data-i18n="vengeful" data-i18n-list-item="vengeful">Vengeful</button>
      </span>
      <span data-i18n-list="revelry-list">
        <input type="hidden" name="attr_revelry" class="suggested" value=""/>
        <button type="action" name="act_revelry-craving" class="suggestion" data-i18n="craving" data-i18n-list-item="craving">Craving</button>
        <button type="action" name="act_revelry-drinking" class="suggestion" data-i18n="drinking" data-i18n-list-item="drinking">Drinking</button>
        <button type="action" name="act_revelry-gambling" class="suggestion" data-i18n="gambling" data-i18n-list-item="gambling">Gambling</button>
        <button type="action" name="act_revelry-occult" class="suggestion" data-i18n="occult" data-i18n-list-item="occult">Occult</button>
        <button type="action" name="act_revelry-violence" class="suggestion" data-i18n="violence" data-i18n-list-item="violence">Violence</button>
        <button type="action" name="act_revelry-worship" class="suggestion" data-i18n="worship" data-i18n-list-item="worship">Worship</button>
      </span>
    </div>
    <div class="sheet-gear">
      <div class="header" data-i18n="gear">Gear</div>
      <fieldset class="repeating_gear">
        <input type="text" name="attr_gear"/>
      </fieldset>
      <div class="header">
        <span data-i18n="supply">Supply</span>
        <input type="hidden" class="toggle complex settings" name="attr_supply-settings"/>
        <button type="action" name="act_toggle-supply-settings" class="toggle symbol">
          <span>y</span>
        </button>
        <span class="complex normal" data-i18n="slots"> Slots</span>
        <input type="number" name="attr_supply-slots" min="2" max="5" class="complex" />
        <input type="hidden" name="attr_supply-slots" class="extra"/>
        <span class="spacer"></span>
        <input type="hidden" class="toggle" name="attr_supply1" />
        <button type="action" name="act_toggle-supply1" class="toggle square extra1">
          <span></span>
        </button>
        <input type="hidden" class="toggle" name="attr_supply2" />
        <button type="action" name="act_toggle-supply2" class="toggle square extra2">
          <span></span>
        </button>
        <input type="hidden" class="toggle" name="attr_supply3" />
        <button type="action" name="act_toggle-supply3" class="toggle square extra3">
          <span></span>
        </button>
        <input type="hidden" class="toggle" name="attr_supply4" />
        <button type="action" name="act_toggle-supply4" class="toggle square extra4">
          <span></span>
        </button>
        <input type="hidden" class="toggle" name="attr_supply5" />
        <button type="action" name="act_toggle-supply5" class="toggle square extra5">
          <span></span>
        </button>
      </div>
      <div>
        <input type="hidden" class="toggle complex settings" name="attr_supply-settings" />
        <fieldset class="repeating_supply">
          <span class="textplus">
            <input type="text" name="attr_supply" size="10" class="textplus" />
            <input type="hidden" name="attr_extra-supply-item" class="extra"/>
            <input type="hidden" class="toggle" name="attr_extra-supply1" />
            <button type="action" name="act_toggle-extra-supply1" class="toggle square extra1">
              <span></span>
            </button>
            <input type="hidden" class="toggle" name="attr_extra-supply2" />
            <button type="action" name="act_toggle-extra-supply2" class="toggle square extra2">
              <span></span>
            </button>
            <input type="hidden" class="toggle" name="attr_extra-supply3" />
            <button type="action" name="act_toggle-extra-supply3" class="toggle square extra3">
              <span></span>
            </button>
          </span>
          <span class="complex">
            <span data-i18n="extra-slots">Extra Slots</span>
            <input type="number" name="attr_extra-supply-item" min="0" max="3"/>
          </span>
          
        </fieldset>
      </div>
    </div>
    <div class="sheet-stress">
      <div class="header">
        <span data-i18n="stress">Stress</span>
      </div>
      <div class="feral" data-i18n="go-feral-stress">When the Clock is full, you Go Feral.</div>
      <div class="stress-clock">
        <input class="size" type="hidden" name="attr_stress-size" value="6"/>
        <div class="clock-container">
          <button class="broadcast-button" type="roll" name="roll_Show" value="" data-i18n-title="send_details_to_chat" title="Send details to chat"></button>
          <div class="spoke-0 all"></div>
          <div class="spoke-30 sheet-12clock"></div>
          <div class="spoke-45 sheet-8clock"></div>
          <div class="spoke-36 sheet-10clock"></div>
          <div class="spoke-60 sheet-6clock sheet-12clock"></div>
          <div class="spoke-72 sheet-10clock"></div>
          <div class="spoke-90 sheet-4clock sheet-8clock sheet-12clock"></div>
          <div class="spoke-108 sheet-10clock"></div>
          <div class="spoke-120 sheet-6clock sheet-12clock"></div>
          <div class="spoke-135 sheet-8clock"></div>
          <div class="spoke-144 sheet-10clock"></div>
          <div class="spoke-150 sheet-12clock"></div>
          <input class="zero input-progress" type="radio" name="attr_stress" value="0" checked="checked"/><span></span>
          <input class="input-progress all" type="radio" name="attr_stress" value="1"/>
          <input class="input-progress all" type="radio" name="attr_stress" value="2"/>
          <input class="input-progress all" type="radio" name="attr_stress" value="3"/>
          <input class="input-progress all" type="radio" name="attr_stress" value="4"/>
          <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="5"/>
          <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="6"/>
          <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="7"/>
          <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="8"/>
          <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="9"/>
          <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_stress" value="10"/>
          <input class="input-progress sheet-12clock" type="radio" name="attr_stress" value="11"/>
          <input class="input-progress sheet-12clock" type="radio" name="attr_stress" value="12"/>
          <div class="clock"></div>
        </div>
      </div>
      <ul class="resist no-bullets">
        <li data-i18n="resistance-rolls" class="subheader">Resistance Rolls</li>
        <li>
          <strong data-i18n="failure">Failure</strong><span data-i18n="resist-failure">: Partial Resist, take 3 Stress.</span>
        </li>
        <li>
          <strong data-i18n="mixed">Mixed</strong><span data-i18n="resist-mixed">: Partial Resist, take 2 Stress.</span>
        </li>
        <li>
          <strong data-i18n="success">Success</strong><span data-i18n="resist-success">: Full Resist, take 1 Stress</span>
        </li>
        <li>
          <strong data-i18n="critical">Critical</strong><span data-i18n="resist-critical">: Full Resist, clear 1 Stress</span>
        </li>
        <li data-i18n="resisting-death" class="subheader">Resisting Death</li>
        <li>
          <strong data-i18n="failure">Failure</strong><span data-i18n="resist-death-failure">: You die.</span>
        </li>
        <li>
          <strong data-i18n="mixed">Mixed</strong><span data-i18n="resist-death-mixed">: Knocked out of the scene.</span>
        </li>
      </ul>
      <div class="defense" >
        <div class="header" data-i18n="defenses">Defenses</div>
        <fieldset class="repeating_defense">
          <span class="textplus">
            <input type="hidden" class="toggle" name="attr_defense-used" />
            <button type="action" name="act_toggle-defense-used" class="toggle square extra3">
              <span></span>
            </button>
            <input type="text" class="textplus" name="attr_defense" size="10"/>
          </span>
        </fieldset>
      </div>
    </div>
    <div class="sheet-abilities">
      Abilities
    </div>
    <div class="sheet-notes">
      <div class="header" data-i18n="notes">Notes</div>
      <div class="auto-expand"><span name="attr_notes"></span>
        <textarea spellcheck="false" name="attr_notes"></textarea>
      </div>
    </div>
  </div>
  <div class="sheet-calling">
    <input type="hidden" class="toggle complex settings" name="attr_calling-settings" value="show"/>
    <button type="action" name="act_toggle-calling-settings" class="toggle symbol settings">
      <span>y</span>
    </button>
    <input type="text" name="attr_calling" class="complex"/>
    <!-- <input type="text" name="attr_calling-desc" class="complex"/> -->
    <div class="auto-expand complex"><span name="attr_calling-desc"></span>
      <textarea spellcheck="false" name="attr_calling-desc"></textarea>
    </div>
    <div class="complex suggestions">
      <input type="hidden" name="attr_calling" class="suggested" value=""/>
      <button type="action" name="act_calling-brute" class="suggestion" data-i18n="brute" data-i18n-list-item="brute">Brute</button>
      <button type="action" name="act_calling-conniver" class="suggestion" data-i18n="conniver" data-i18n-list-item="conniver">Conniver</button>
      <button type="action" name="act_calling-crafter" class="suggestion" data-i18n="crafter" data-i18n-list-item="crafter">Crafter</button>
      <button type="action" name="act_calling-hunter" class="suggestion" data-i18n="hunter" data-i18n-list-item="hunter">Hunter</button>
      <button type="action" name="act_calling-marauder" class="suggestion" data-i18n="marauder" data-i18n-list-item="marauder">Marauder</button>
      <button type="action" name="act_calling-shadow" class="suggestion" data-i18n="shadow" data-i18n-list-item="shadow">Shadow</button>
      <button type="action" name="act_calling-shaman" class="suggestion" data-i18n="shaman" data-i18n-list-item="shaman">Shaman</button>
      <button type="action" name="act_calling-warlock" class="suggestion" data-i18n="warlock" data-i18n-list-item="warlock">Warlock</button>
      <button type="action" name="act_calling-zealot" class="suggestion" data-i18n="zealot" data-i18n-list-item="zealot">Zealot</button>
    </div>
    <span name="attr_calling" class="simple"></span>
    <span name="attr_calling-desc" class="simple right pre"></span>
  </div>
  <div class="sheet-middle">
    <div class="sheet-minions">
      Minions
    </div>
    <div class="sheet-duties">
      <div class="header"> 
        <span data-i18n="dungeon-duties">Dungeon Duties</span>
        <input type="hidden" class="toggle" name="attr_hide-duties" value="show"/>
        <button type="action" name="act_toggle-duties" class="toggle arrow">
          <span class="show">▼</span>
          <span class="hide">◄</span>
        </button>
      </div>
      <input type="hidden" class="hider" name="attr_hide-duties"/>
      <div class="hider">
        <div class="duties-header">
          <div data-i18n="tier">Tier</div>
          <div data-i18n="type">Type</div>
          <div data-i18n="description">Description</div>
        </div>
        <fieldset class="repeating_duties">
          <input type="text" name="attr_duty-tier"/>
          <input type="text" name="attr_duty-type"/>
          <div class="auto-expand"><span name="attr_duty-desc"></span>
            <textarea spellcheck="false" name="attr_duty-desc"></textarea>
          </div>
        </fieldset>
      </div>
    </div>
    <div class="sheet-downtime clocks">
      <div class="header">
        <span data-i18n="downtime-projects">Downtime Projects</span>
        <input type="hidden" class="toggle arrow" name="attr_hide-downtime-list" value="show"/>
        <button type="action" name="act_toggle-downtime-list" class="toggle">
          <span class="show">▼</span>
          <span class="hide">◄</span>
        </button>
      </div>
      <input type="hidden" name="attr_hide-downtime-list" class="hider"/>
      <div class="hider">
        <ul data-i18n-list="projects-list">
          <li data-i18n="brew-project" data-i18n-list-item="brew"><strong>Brew</strong> Potions and Alchemicals</li>
          <li data-i18n="build-project" data-i18n-list-item="build"><strong>Build</strong> Locks, Traps, Tricks, and Rooms.</li>
          <li data-i18n="contact-project" data-i18n-list-item="contact"><strong>Contact</strong> Vile Friends, NPCs, or Factions.</li>
          <li data-i18n="craft-project" data-i18n-list-item="craft"><strong>Craft</strong> an Item, Edge, or Contraption</li>
          <li data-i18n="incant-project" data-i18n-list-item="incant"><strong>Incant</strong> a Ritual.</li>
          <li data-i18n="recruit-project" data-i18n-list-item="recruit"><strong>Recruit</strong> a Pack of Minions</li>
          <li data-i18n="torture-project" data-i18n-list-item="torture"><strong>Torture</strong> a Prisoner</li>
        </ul>
      </div>
      <fieldset class="repeating_projects grid">
        <div>
          <input class="size" type="hidden" name="attr_size" value=""/>
          <div class="size-choice">
            <label class="text-button">
              <input type="radio" name="attr_size" value="4"/><span>4</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="6"/><span>6</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="8"/><span>8</span>
            </label>
            <!--
            <label class="text-button">
              <input type="radio" name="attr_size" value="10"/><span>10</span>
            </label>
            <label class="text-button">
              <input type="radio" name="attr_size" value="12"/><span>12</span>
            </label>
            -->
          </div>
          <div class="clock-container">
            <button class="broadcast-button" type="roll" name="roll_Show" value="&amp;{template:bitd-broadcast}{{charname=@{character_name}}} {{title=@{name}}} {{clock=1}} {{clocksize=@{size}}} {{clockprogress=@{progress}}} {{charimage=@{chat_image}}}" data-i18n-title="send_details_to_chat"></button>
            <div class="spoke-0 all"></div>
            <div class="spoke-30 sheet-12clock"></div>
            <div class="spoke-45 sheet-8clock"></div>
            <div class="spoke-36 sheet-10clock"></div>
            <div class="spoke-60 sheet-6clock sheet-12clock"></div>
            <div class="spoke-72 sheet-10clock"></div>
            <div class="spoke-90 sheet-4clock sheet-8clock sheet-12clock"></div>
            <div class="spoke-108 sheet-10clock"></div>
            <div class="spoke-120 sheet-6clock sheet-12clock"></div>
            <div class="spoke-135 sheet-8clock"></div>
            <div class="spoke-144 sheet-10clock"></div>
            <div class="spoke-150 sheet-12clock"></div>
            <input class="zero input-progress" type="radio" name="attr_progress" value="0" checked="checked"/><span></span>
            <input class="input-progress all" type="radio" name="attr_progress" value="1"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="2"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="3"/>
            <input class="input-progress all" type="radio" name="attr_progress" value="4"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="5"/>
            <input class="input-progress sheet-6clock sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="6"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="7"/>
            <input class="input-progress sheet-8clock sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="8"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="9"/>
            <input class="input-progress sheet-10clock sheet-12clock" type="radio" name="attr_progress" value="10"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="11"/>
            <input class="input-progress sheet-12clock" type="radio" name="attr_progress" value="12"/>
            <div class="clock"></div>
          </div>
        </div>
        <div class="auto-expand"><span name="attr_project"></span>
          <textarea spellcheck="false" name="attr_project" data-i18n-placeholder="project" placeholder="Project"></textarea>
        </div>
      </fieldset>
      <div>
        <ul>
          <li data-i18n="risk-it-downtime"><strong>Risk it:</strong> Re-roll a Downtime Action but lose its Dominant Position.</li>
        </ul>
      </div>
    </div>
    <div class="sheet-gold">
      Gold
    </div>
  </div>
  <div class="sheet-right">
    <div class="sheet-actions">
      <div>
        <div class="header">
          <input type="hidden" name="attr_brains-shock" class="toggle"/>
          <button type="action" name="act_toggle-brains-shock" class="toggle diamond"></button>
          <span data-i18n="brains">Brains</span> &nbsp;
          <span class="subheader" data-i18n="brains-desc">Smarts, Awareness, Insight</span>
        </div>
        <div class="header">
          <input type="hidden" name="attr_scan" value="0" class="action"/>
          <button type="action" name="act_scan1" class="practice square toggle action1"></button>
          <button type="action" name="act_scan2" class="square toggle action2"></button>
          <button type="action" name="act_scan3" class="square toggle action3"></button>
          <span data-i18n="scan">Scan</span> &nbsp; <em class="normal" data-i18n="perceptively"> / perceptively</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_tinker" value="0" class="action"/>
          <button type="action" name="act_tinker1" class="practice square toggle action1"></button>
          <button type="action" name="act_tinker2" class="square toggle action2"></button>
          <button type="action" name="act_tinker3" class="square toggle action3"></button>
          <span data-i18n="tinker">Tinker</span> &nbsp; <em class="normal" data-i18n="cleverly"> / cleverly</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_trick" value="0" class="action"/>
          <button type="action" name="act_trick1" class="practice square toggle action1"></button>
          <button type="action" name="act_trick2" class="square toggle action2"></button>
          <button type="action" name="act_trick3" class="square toggle action3"></button>
          <span data-i18n="trick">Trick</span> &nbsp; <em class="normal" data-i18n="slyly"> / slyly</em>
        </div>
      </div>
      <div>
        <div class="header">
          <input type="hidden" name="attr_muscles-shock" class="toggle"/>
          <button type="action" name="act_toggle-muscles-shock" class="toggle diamond"></button>
          <span data-i18n="muscles">Muscles</span> &nbsp;
          <span class="subheader" data-i18n="muscles-desc">Strength, Agility, Speed</span>
        </div>
        <div class="header">
          <input type="hidden" name="attr_finesse" value="0" class="action"/>
          <button type="action" name="act_finesse1" class="practice square toggle action1"></button>
          <button type="action" name="act_finesse2" class="square toggle action2"></button>
          <button type="action" name="act_finesse3" class="square toggle action3"></button>
          <span data-i18n="finesse">Finesse</span> &nbsp; <em class="normal" data-i18n="precisely"> / precisely</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_skulk" value="0" class="action"/>
          <button type="action" name="act_skulk1" class="practice square toggle action1"></button>
          <button type="action" name="act_skulk2" class="square toggle action2"></button>
          <button type="action" name="act_skulk3" class="square toggle action3"></button>
          <span data-i18n="skulk">Skulk</span> &nbsp; <em class="normal" data-i18n="sneakily"> / sneakily</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_smash" value="0" class="action"/>
          <button type="action" name="act_smash1" class="practice square toggle action1"></button>
          <button type="action" name="act_smash2" class="square toggle action2"></button>
          <button type="action" name="act_smash3" class="square toggle action3"></button>
          <span data-i18n="smash">Smash</span> &nbsp; <em class="normal" data-i18n="powerfully"> / powerfully</em>
        </div>
      </div>
      <div>
        <div class="header">
          <input type="hidden" name="attr_guts-shock" class="toggle"/>
          <button type="action" name="act_toggle-guts-shock" class="toggle diamond"></button>
          <span data-i18n="guts">Guts</span> &nbsp;
          <span class="subheader" data-i18n="guts-desc">Personality, Mettle, Magic</span>
        </div>
        <div class="header">
          <input type="hidden" name="attr_banter" value="0" class="action"/>
          <button type="action" name="act_banter1" class="practice square toggle action1"></button>
          <button type="action" name="act_banter2" class="square toggle action2"></button>
          <button type="action" name="act_banter3" class="square toggle action3"></button>
          <span data-i18n="banter">Banter</span> &nbsp; <em class="normal" data-i18n="affably"> / affably</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_invoke" value="0" class="action"/>
          <button type="action" name="act_invoke1" class="practice square toggle action1"></button>
          <button type="action" name="act_invoke2" class="square toggle action2"></button>
          <button type="action" name="act_invoke3" class="square toggle action3"></button>
          <span data-i18n="invoke">Invoke</span> &nbsp; <em class="normal" data-i18n="magically"> / magically</em>
        </div>
        <div class="header">
          <input type="hidden" name="attr_threaten" value="0" class="action"/>
          <button type="action" name="act_threaten1" class="practice square toggle action1"></button>
          <button type="action" name="act_threaten2" class="square toggle action2"></button>
          <button type="action" name="act_threaten3" class="square toggle action3"></button>
          <span data-i18n="threaten">Threaten</span> &nbsp; <em class="normal" data-i18n="forcefully"> / forcefully</em>
        </div>
      </div>
      <div class="small header">
        <input type="hidden" name="attr_bloodied" class="toggle"/>
        <button type="action" name="act_toggle-bloodied" class="toggle diamond"></button>
        <span data-i18n="bloodied">Bloodied</span>
      </div>
      <div class="small header">
        <span data-i18n="dark-hearts">Dark Hearts</span>
        <input type="hidden" name="attr_dark-heart1" class="toggle"/>
        <button type="action" name="act_toggle-dark-heart1" class="toggle diamond"></button>
        <input type="hidden" name="attr_dark-heart2" class="toggle"/>
        <button type="action" name="act_toggle-dark-heart2" class="toggle diamond"></button>
      </div>
      <div>
        <ul>
          <li><strong data-i18n="assist">Assist</strong>: <span data-i18n="assist-desc">Give +Effect, but open to consequence.</span></li>
          <li><strong data-i18n="go-hard">Go Hard</strong>: <span data-i18n="go-hard-desc">Trade +Effect for &#8209;Position.</span></li>
          <li><strong data-i18n="team-up">Team Up</strong>: <span data-i18n="team-up-desc">Take the highest result, but each PC with a Mixed or Failure takes stress.</span></li>
          <li><strong data-i18n="dark-bargain">Dark Bargain</strong>: <span data-i18n="dark-bargain-desc">Trade +1D for a Consequence.</span></li>
          <li><strong data-i18n="dark-heart">Dark Heart</strong>: <span data-i18n="dark-heart-desc">Take +1D on a roll.</span></li>
        </ul>
      </div>
      <div>
        <hr/>
      </div>
      <div>
        <ul>
          <li><strong data-i18n="shock">Shock</strong>: <span data-i18n="shock-desc">Take &#8209;1D on next roll, then clears.</span></li>
          <li><strong data-i18n="bloodied">Bloodied</strong>: <span data-i18n="bloodied-desc">Take Shock to all Attributes, and clears when all Shock is clear.</span></li>
          <li><strong data-i18n="death-knell">Death Knell</strong>: <span data-i18n="death-knell-desc">Take a Final Action if you have a Dark Heart left when you die.</span></li>
          <li><strong data-i18n="go-feral">Go Feral</strong>: <span data-i18n="go-feral-desc">Immediately Compelled; Abilities used during this Action cost no Stress.</span></li>
        </ul>
      </div>
    </div>
    <div class="sheet-friend">
      Vile Friend
    </div>
    <div class="sheet-raid">
      Raid
    </div>
  </div>
  <div class="sheet-xp">
    <div class="wicked">
      <div class="header">
        <span data-i18n="wicked-xp" class="nowrap">Wicked XP</span>
        <span class="spacer"></span>
        <input type="hidden" name="attr_wicked1" class="toggle"/>
        <button type="action" name="act_toggle-wicked1" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked2" class="toggle"/>
        <button type="action" name="act_toggle-wicked2" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked3" class="toggle"/>
        <button type="action" name="act_toggle-wicked3" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked4" class="toggle"/>
        <button type="action" name="act_toggle-wicked4" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked5" class="toggle"/>
        <button type="action" name="act_toggle-wicked5" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked6" class="toggle"/>
        <button type="action" name="act_toggle-wicked6" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked7" class="toggle"/>
        <button type="action" name="act_toggle-wicked7" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked8" class="toggle"/>
        <button type="action" name="act_toggle-wicked8" class="toggle tall"></button>
        <input type="hidden" name="attr_wicked9" class="toggle"/>
        <button type="action" name="act_toggle-wicked9" class="toggle tall"></button>
      </div>
      <div data-i18n="wicked-xp-desc">Take an Ability when full. Mark 1 XP for each you did this session:</div>
      <ul>
        <li data-i18n="wicked-trigger-1">You made progress on you Master Plan.</li>
        <li data-i18n="wicked-trigger-2">You jumped into someone else's dungeon scene.</li>
        <li data-i18n="wicked-trigger-3">You acted like a monster.</li>
        <li data-i18n="wicked-trigger-4">You used your Gear or Supply in creative ways.</li>
      </ul>
    </div>
    <div>
      <div class="header">
        <span data-i18n="reckless-xp">Reckless XP</span>
        <span class="spacer"></span>
        <input type="hidden" name="attr_reckless1" class="toggle"/>
        <button type="action" name="act_toggle-reckless1" class="toggle tall"></button>
        <input type="hidden" name="attr_reckless2" class="toggle"/>
        <button type="action" name="act_toggle-reckless2" class="toggle tall"></button>
        <input type="hidden" name="attr_reckless3" class="toggle"/>
        <button type="action" name="act_toggle-reckless3" class="toggle tall"></button>
      </div>
      <div data-i18n="reckless-xp-desc">Take an Action dot when full.<br/>
        Mark 1 XP if you played into being Bloodied or Going Feral this session.</div>
    </div>
    <div class="light-words">
      <div class="header" data-i18n="light-tongue-words">Light Tongue Words</div>
      <span data-i18n="you">You</span>
      <span data-i18n="me">Me</span>
      <span data-i18n="us">Us</span>
      <span data-i18n="it">It</span>
      <span data-i18n="one">One</span>
      <span data-i18n="two">Two</span>
      <span data-i18n="three">Three</span>
      <span data-i18n="more">More</span>
      <span data-i18n="yes">Yes</span>
      <span data-i18n="no">No</span>
      <span data-i18n="maybe">Maybe</span>
      <span data-i18n="now">Now</span>
      <span data-i18n="go">Go</span>
      <span data-i18n="do">Do</span>
      <span data-i18n="stop">Stop</span>
      <span data-i18n="kill">Kill</span>
      <span data-i18n="eat">Eat</span>
      <span data-i18n="give">Give</span>
      <span data-i18n="get">Get</span>
      <span data-i18n="gold">Gold</span>
    </div>
  </div>
</div>
<script type="text/worker">
  on("sheet:opened", function(eventInfo) {
    getAttrs(["supply-slots"], function(v){
      set = {};
      if (v["supply-slots"] === "") set["supply-slots"] = 2;
      setAttrs(set);
    });
  });

  function getClickAttr(eventInfo, prefix){
    return eventInfo.triggerName.replace(new RegExp(`clicked:(repeating_.+?_)?.*${prefix}-`), "$1")
  }

  on("clicked:toggle-downtime-list clicked:toggle-duties", function(eventInfo) {
    //get the right attribute for the button we clicked
    var attr = eventInfo.triggerName.replace("clicked:toggle", "hide")
    
    toggle(attr, "hide", "show")

    //console.log(eventInfo);
  });

  function toggle(attr, on, off){
    // Check the current value of the hidden attribute.
    //console.log(arguments)
    getAttrs([attr], function(v) {
      // Toggle the hidden attribute value between "hide" and "show"
      var set = {}
      set[attr] = v[attr] !== on ? on : off
      setAttrs(set);
      //console.log(set);
    });
  }

  function eventList(count, ...events) {
    if (isNaN(events[0])){
      var nums = [...Array(count).keys()];
    } else {
      var nums = [...Array(events[0]).keys()].slice(count-1);
      events = events.slice(1);
    }
    nums = nums.map(v => v + 1);
    return events.flatMap( e => nums.map( v => e + v)).join(" ");
  }

  on(eventList(5, "clicked:toggle-supply", "clicked:repeating_supply:toggle-extra-supply", "clicked:toggle-dark-heart", "clicked:toggle-reckless"), function(eventInfo){
    var attr = eventInfo.triggerName.replace(/clicked:(repeating_.+?_)?.*toggle-/, "$1")
    toggle(attr, "used", "0");
    //console.log(eventInfo);
  });

  //on("clicked:repeating_defense:toggle-defense-used", function(eventInfo){
  //  toggle("repeating_defense_defense-used", "used", "0");
  //});

  on("clicked:repeating_defense:toggle-defense-used clicked:toggle-brains-shock clicked:toggle-muscles-shock clicked:toggle-guts-shock clicked:toggle-bloodied", function(eventInfo){
    //console.log(eventInfo)
    var attr = eventInfo.triggerName.replace(/clicked:(repeating_.+?_)?.*toggle-/, "$1")
    toggle(attr,"used","0")
  });

  on("clicked:toggle-supply-settings clicked:toggle-calling-settings", function(eventInfo){
    var attr = getClickAttr(eventInfo, "toggle");
    console.log(attr)
    console.log(eventInfo)
    toggle(attr, "show", "hide")
  });

  on("clicked:impulse-bigmouth clicked:impulse-cruel clicked:impulse-deranged clicked:impulse-fickle clicked:impulse-obsessed clicked:impulse-paranoid clicked:impulse-reckless clicked:impulse-vengeful", function(eventInfo) {
    var impulse = eventInfo.triggerName.replace("clicked:impulse-", "")
    impulse = getTranslationByKey(impulse)
    setAttrs({
      impulse: impulse
    });
  });

  on("clicked:revelry-craving clicked:revelry-drinking clicked:revelry-gambling clicked:revelry-occult  clicked:revelry-violence clicked:revelry-worship", function(eventInfo){
    var rev = eventInfo.triggerName.replace("clicked:revelry-", "")
    rev = getTranslationByKey(rev)
    setAttrs({
      revelry: rev
    });
  });

  on(eventList(3,"clicked:scan","clicked:tinker","clicked:trick","clicked:finesse","clicked:skulk","clicked:smash","clicked:banter","clicked:invoke","clicked:threaten"), function(eventInfo){
    var match = eventInfo.triggerName.match(/clicked:(.+)(\d)/)
    var attr = match[1]
    var set = {}
    if (match[2] == "1"){
      getAttrs([attr], v => {
        switch(v[attr]){
          case "0": set[attr] = "0.1"; break;
          case "0.1": set[attr] = "0.2"; break;
          case "0.2": set[attr] = "1"; break;
          case "1": set[attr] = "0"; break;
          default: set[attr] = "1"; break;
        }
        setAttrs(set);
      });
    } else {
      set[attr] = match[2];
      setAttrs(set);
    }
    //console.log(match)
  });

  on(eventList(9, "clicked:toggle-wicked"), function(eventInfo){
    var attr = eventInfo.triggerName.replace(/clicked:(repeating_.+?_)?.*toggle-/, "$1")
    toggle(attr, "used", "0");
  });

  on("clicked:calling-brute clicked:calling-conniver clicked:calling-crafter clicked:calling-hunter clicked:calling-marauder clicked:calling-shadow clicked:calling-shaman clicked:calling-warlock clicked:calling-zealot", function(eventInfo){
    var key = getClickAttr(eventInfo, "calling")
    var calling = getTranslationByKey(key)
    var desc = _.unescape(getTranslationByKey(key + "-desc"));
    setAttrs({
      calling: calling, 
      "calling-desc": desc,
      "calling-settings": "hide"
    });
  })

</script>
<div class="translation-holder">
  <span data-i18n="brute-desc">Powerful & Intimidating 
 Brawlers</span>
  <span data-i18n="conniver-desc">Manipulative & Controlling 
 Masterminds</span>
  <span data-i18n="crafter-desc">Clever & Curious 
 Tinkerers</span>
  <span data-i18n="hunter-desc">Ruthless & Tenacious 
 Trackers</span>
  <span data-i18n="marauder-desc">Cunning & Fearless 
 Warriors</span>
  <span data-i18n="shadow-desc">Sneaky & Elusive 
 Rogues</span>
  <span data-i18n="shaman-desc">Terrifying & Vengeful 
 Witches</span>
  <span data-i18n="warlock-desc">Daring & Ambitious 
 Mages</span>
  <span data-i18n="zealot-desc">Fervent & Mystical 
 Believers</span>
</div>