<div class="charsheet-container">

    <div class="area-header"></div>
    
    <div class="area-left-column">
    </div>
    <div class="area-right-column">
    </div>
    

    <div class="area-left-content">
        <div class="area-weapons">
            <div class="weapons-banner">Primary Attacks</div>
            <span>
                <b>GM needs to create a rollable table called "Combat-Dice" with name values of "1","2","-","-","1 +
                Special Event","1 + Special Event"</b>
            </span>
            <div class="weapons-bonus-grid">
                <div class="weapons-bonus-hdr-background field-border-wide">
                    <div class="weapons-bonus-hdr-label">BONUS DAMAGE</div>
                </div>
                <div class="field-border-narrow">Ranged</div>
                <span class="input-field-medium" name="attr_weapon_damagebonus_range"></span>
                <div class="field-border-narrow">Melee</div>
                <span class="input-field-medium" name="attr_weapon_damagebonus_melee"></span>
                <div class="field-border-narrow">Presence</div>
                <span class="input-field-medium"style="width:80%;" name="attr_weapon_damagebonus_presence"></span>
            </div>
            <div class="weapons-separator"></div>
            <fieldset class="repeating_weapons">
                <div class="weapons-weapon-grid">
                    <div class="weapons-weapon-name" >Weapon Name</div>
                    <input class="input-field-medium sheet-col-span-3-2" style="text-align: left;margin-left: 2px;padding-left: 5px;" type="text" name="attr_weapon_name"/>
                    <div class="weapons-weapon-grid-button-group">
                        Roll:
                        <button type='roll' name="roll_Combat-Dice"
                            value="&{template:damage} {{character_name=@{character_name}}} {{weaponname=@{weapon_name}}} {{rangereach=@{weapon_reach}}} {{size=@{weapon_size}}} {{damage=@{weapon_damage}}}{{qualities=@{weapon_qualities}}}{{bonusdamage=@{weapon_type}}}{{totaldamage=[[(@{weapon_damage}+@{weapon_type})t[Combat-Dice]]]}} {{areastruck=[[t[Hit-Location-Table]]]}}">
                        </button>
                    </div>
                    <div class="weapons-weapon-labels field-border-narrow">Type</div>
                    <div class="weapons-weapon-labels field-border-medium">Range/Reach</div>
                    <div class="weapons-weapon-labels field-border-narrow">Size</div>
                    <div class="weapons-weapon-labels field-border-medium">Damage</div>
                    <div class="weapons-weapon-labels field-border-medium">Loads</div>
                    <select class="input-field-medium" name="attr_weapon_type" title="Weapon Type">
                        <option value="@{weapon_damagebonus_melee}" selected>Melee</option>
                        <option value="@{weapon_damagebonus_range}">Range</option>
                    </select>
                    <input class="input-field-medium" type="text" name="attr_weapon_reach" />
                    <select class="input-field-medium" name="attr_weapon_size" title="Weapon Size: 1-Handed, 2-Handed, Unbalanced, Unwieldy, Fixed, Monstrous">
                        <option value="1H" selected>1H</option>
                        <option value="2H">2H</option>
                        <option value="UB">UB</option>
                        <option value="UW">UW</option>
                        <option value="Fixed">Fixed</option>
                        <option value="M">M</option>
                    </select>
                    <input class="input-field-medium" type="text" name="attr_weapon_damage" />
                    <input class="input-field-medium" type="text" name="attr_weapon_loads" />
                    <div class="weapons-weapon-labels field-border-medium">Qualities</div>
                    <input class="input-field-medium col-span-2-4" style="text-align: left;padding-left: 5px;" type="text" name="attr_weapon_qualities" />
                </div>
            </fieldset>
        </div>

        <div class="area-stress-harms">
            <div class="stress-harms">
                <!-- row 1-->
                <div class="col-span-1-1"></div>
                <div class="stress-harm-banner col-span-2-6">Stress & Harms</div>
                <div class="col-span-8-2 row-span-1-5 sh-vigor-grid">
                    <div class="col-span-1-5 sh-physical-label-background">
                        <div class="sh-label1">PHYSICAL</div>
                    </div>
                    <div class="col-span-1-5 sh-vigor-label-background">
                        <div class="field-border-medium sh-vigor-label">
                            <button style="float: left;">-</button>
                            Vigor
                            <button style="float: right;">+</button>
                        </div>
                    </div>
                    <!-- row 1-->
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <!-- row 2-->
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <!-- row 3-->
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <!-- row 4-->
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                    <div class="sh-vigor-input-box"></div>
                </div>
                <!-- row 2-->
                <div class="col-span-1-1"></div>
                <div class="col-span-2-3 sh-label1">COURAGE</div>
                <div class="col-span-5-3 input-field-medium">
                    <input class="sh-field-input" type="text" name="attr_Courage"/>
                </div>
                <!-- row 3-->
                <div class="sh-label2 col-span-2-6" style="margin: 0px 1px 0px 3px; height:80%; line-height: 45px;">Armour Soak</div>
                <!-- row 4-->
                <div class="col-span-1-1"></div>
                <div class="col-span-2-2"></div>
                <div class="col-span-4-2 sh-bodypart-name">HEAD</div>
                <div class="col-span-6-2"></div>
                <!-- row 5-->
                <div class="col-span-1-3"></div>
                <div class="col-span-4-2 field-border-narrow sh-bodypart-range">1-2</div>
                <div class="col-span-6-2"></div>
                <!-- row 6-->
                <div class="col-span-1-3"></div>
                <div class="col-span-4-2 row-span-6-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_Head_Soak" value="0"/>
                    <select name="attr_Head_Armour">
                        <option value="Naked">Naked</option>
                        <option value="Cloth hat or coif">Cloth hat or coif</option>
                        <option value="Padded">Padded</option>
                        <option value="Mail coif">Mail coif</option>
                        <option value="Skull cap">Skull cap</option>
                        <option value="Aventail (noisy)">Aventail (noisy)</option>
                        <option value="Sallet (heavy)">Sallet (heavy)</option>
                        <option value="Bascinet (heavy)">Bascinet (heavy)</option>
                        <option value="Turban Helmut (heavy)">Turban Helmut (heavy)</option>
                        <option value="Nord Helmut (heavy)">Nord Helmut (heavy)</option>
                        <option value="Great Helm (noisy/heavy)">Great Helm (noisy/heavy)</option>
                        <option value="Bascient w/visor (noisy/heavy)">Bascient w/visor (noisy/heavy)</option>
                    </select>
                </div>
                <div class="col-span-6-2"></div>
                <div class="col-span-8-2 row-span-6-2 sh-wounds-grid">
                    <div class="col-span-1-5 sh-wounds-label">
                        <button style="float: left;">-</button>
                        WOUNDS
                        <button style="float: right;">+</button>
                    </div>
                    <div class="sh-wounds-input-box"></div>
                    <div class="sh-wounds-input-box"></div>
                    <div class="sh-wounds-input-box"></div>
                    <div class="sh-wounds-input-box"></div>
                    <div class="sh-wounds-input-box"></div>
                </div>
                <!-- row 7-->
                <div class="col-span-1-3"></div>
                <div class="col-span-6-2"></div>            
                
                <!-- row 8-->
                <div class="col-span-2-2 sh-bodypart-name">R. ARM</div>
                <div class="col-span-4-2"></div>
                <div class="col-span-6-2 sh-bodypart-name">L. ARM</div>
                <div class="col-span-8-2">
                    <span class="fatigue-despair-label">Fatigue</span>
                    <button>-</button>
                    <input class="input-field-narrow fatigue-despair-input-box" type="text" name="attr_Fatigue" value="0" />
                    <button>+</button>
                </div>
                <!-- row 9-->
                <div class="col-span-2-2 field-border-narrow sh-bodypart-range">3-5</div>
                <div class="col-span-4-2 sh-bodypart-name">TORSO</div>
                <div class="col-span-6-2 field-border-narrow sh-bodypart-range">6-8</div>
                <div class="col-span-8-2 row-span-9-8 sh-resolve-grid">
                    <div class="col-span-1-5 sh-mental-label-background">
                        <div class="sh-label1">Mental</div>
                    </div>
                    <div class="col-span-1-5 sh-resolve-label-background">
                        <div class="field-border-medium  sh-resolve-label">
                            <button style="float: left;">-</button>
                            RESOLVE
                            <button style="float: right;">+</button>
                        </div>
                    </div>
                    <!-- row 1-->
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <!-- row 2-->
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <!-- row 3-->
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <!-- row 4-->
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                    <div class="sh-resolve-input-box"></div>
                </div>
                <!-- row 10-->
                <div></div>
                <div class="col-span-2-2 row-span-10-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_RA_Soak" value="0" />
                    <select name="attr_RA_Armour">
                        <option value="None/Cloth">None/Cloth</option>
                        <option value="Heavy Clothing">Heavy Clothing</option>
                        <option value="Light Armor">Light Armor</option>
                        <option value="Heavy Armor">Heavy Armor</option>
                        <option value="Very Heavy Armor">Very Heavy Armor</option>
                    </select>
                </div>
                <div class="col-span-4-2 field-border-narrow sh-bodypart-range">9-14</div>
                <div class="col-span-6-2 row-span-10-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_LA_Soak" value="0" />
                    <select name="attr_LA_Armour">
                        <option value="None/Cloth">None/Cloth</option>
                        <option value="Heavy Clothing">Heavy Clothing</option>
                        <option value="Light Armor">Light Armor</option>
                        <option value="Heavy Armor">Heavy Armor</option>
                        <option value="Very Heavy Armor">Very Heavy Armor</option>
                    </select>
                </div>            
                <!-- row 11-->
                <div></div>
                <div class="col-span-4-2 row-span-11-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_Torso_Soak" value="0" />
                    <select name="attr_Torso_Armour">
                        <option value="None/Cloth">None/Cloth</option>
                        <option value="Heavy Clothing">Heavy Clothing</option>
                        <option value="Light Armor">Light Armor</option>
                        <option value="Heavy Armor">Heavy Armor</option>
                        <option value="Very Heavy Armor">Very Heavy Armor</option>
                    </select>
                </div>
                <!-- row 12-->
                <!-- row 13-->
                <div class="col-span-1-7"></div>
                <!-- row 14-->
                <div class="col-span-3-2 sh-bodypart-name">R. LEG</div>
                <div class="col-span-5-2 sh-bodypart-name">L. LEG</div>
                <!-- row 15-->
                <div class="col-span-1-2"></div>
                <div class="col-span-3-2 field-border-narrow sh-bodypart-range">15-17</div>
                <div class="col-span-5-2 field-border-narrow sh-bodypart-range">18-20</div>
                <div></div>
                <div></div>
                <!-- row 16-->
                <div class="col-span-1-2"></div>
                <div class="col-span-3-2 row-span-16-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_RL_Soak" value="0" />
                    <select name="attr_RL_Armour">
                        <option value="None/Cloth">None/Cloth</option>
                        <option value="Heavy Clothing">Heavy Clothing</option>
                        <option value="Light Armor">Light Armor</option>
                        <option value="Heavy Armor">Heavy Armor</option>
                        <option value="Very Heavy Armor">Very Heavy Armor</option>
                    </select>
                </div>
                <div class="col-span-5-2 row-span-16-2 field-border-medium sh-stacked-input-box">
                    <input type="text" name="attr_LL_Soak" value="0" />
                    <select name="attr_LL_Armour">
                        <option value="None/Cloth">None/Cloth</option>
                        <option value="Heavy Clothing">Heavy Clothing</option>
                        <option value="Light Armor">Light Armor</option>
                        <option value="Heavy Armor">Heavy Armor</option>
                        <option value="Very Heavy Armor">Very Heavy Armor</option>
                    </select>
                </div>
                <!-- row 17-->
                <div class="col-span-8-2 row-span-17-2 sh-trauma-grid">
                    <div class="col-span-1-5 sh-trauma-label">
                        <button style="float: left;">-</button>
                        TRAUMA
                        <button style="float: right;">+</button>
                    </div>
                    <div class="sh-trauma-input-box"></div>
                    <div class="sh-trauma-input-box"></div>
                    <div class="sh-trauma-input-box"></div>
                    <div class="sh-trauma-input-box"></div>
                    <div class="sh-trauma-input-box"></div>
                </div>
                <!-- row 18-->
                <div class="sh-label2 col-span-2-6 row-span-18-2" style="margin-top: 10px;height:80%; line-height: 40px;">Armour Qualities</div>
                <div class="col-span-8-2">
                    <span class="fatigue-despair-label">Despair</span>
                    <button>-</button>
                    <input class="input-field-narrow fatigue-despair-input-box" type="text" name="attr_Despair" value="0" />
                    <button>+</button>
                </div>
                <!-- row 19-->
                <div></div>
                <div class="col-span-2-6 input-field-wide">
                    <input class="sh-armour-quality-input" type="text" name="attr_Armour_Qualities" />
                </div>
            </div>
        </div>


        <div class="area-belongings">
            <div class="belongings-banner">Belongings</div>
            <div class="belongings-outergrid">
                <!-- repeating section of belongings rows (grid) -->
                <fieldset class="repeating_belongings col-span-1-1 row-span-1-2">
                    <div class="belongings-list">
                        <div class="field-border-narrow belongings-list-hdr">Type</div>
                        <div class="field-border-narrow belongings-list-hdr">Location</div>
                        <div class="field-border-narrow belongings-list-hdr">Weight</div>
                        <div class="field-border-narrow belongings-list-hdr">Condition</div>
                        <div class="field-border-narrow belongings-list-hdr">Value</div>
                        <input class="input-field-narrow" type="text" name="attr_belongings-item-type" />
                        <input class="input-field-narrow" type="text" name="attr_belongings-item-location"/>
                        <input class="input-field-narrow" type="text" name="attr_belongings-item-weight"/>
                        <input class="input-field-narrow" type="text" name="attr_belongings-item-condition"/>
                        <input class="input-field-narrow" type="text" name="attr_belongings-item-value"/>
                        <div class="field-border-narrow belongings-list-hdr">Description</div>
                        <input class="input-field-narrow col-span-2-4" style="text-align: left;" type="text" name="attr_belongings-item-desc" />
                    </div>
                </fieldset>
                <div class="belongings-cointracker col-span-2-1 row-span-1-1">
                    <div class="belongings-gold">
                        <div class="belongings-gold-banner">GOLD</div>
                        <div><input type="text" name="attr_GoldTotal" /></div>
                    </div>
                    <div class="belongings-upkeep">
                        <div class="belongings-upkeep-banner">UPKEEP</div>
                        <div><input type="text" name="attr_GoldUpkeep" /></div>
                        <div class="belongings-upkeep-spend">
                            <button>Spend</button>
                        </div>
                    </div>
                </div>
                <div class="field-border-wide belongings-totals">
                    <div>Total Worth: <span id="total_wortk">0</span></div>
                    <div>Total Encumberance: <span id="total_wortk">0</span></div>                    
                </div>
            </div>
            <!--
            <textarea name="attr_Belongings"></textarea>
            <table border="1" style="width:100%">
                <tr style="text-align: center;font-size: 1.25em;">
                    <td>Gold - Total:&nbsp;<input style=width:50px type="text" name="attr_GoldTotal" /></td>
                    <td>Upkeep:&nbsp;<input style=width:50px type="text" name="attr_GoldUpkeep" /></td>
                </tr>            
            </table>
            -->
        </div>
    </div>

    <div class="area-center-content">
        <div class="area-characteristics">
            <div class="char-banner">
                <input class="sheet-banner-char-name-input" type="text" name="attr_character_name" />
            </div>
            <div class="char-characteristics">
                <!--
                <span>Name</span>
                <input type="text" name="attr_character_name" />
                -->
                <span>Gender&nbsp;&nbsp;</span>
                <input type="text" name="attr_Gender" />
                <span>Age&nbsp;&nbsp;</span>
                <input type="text" name="attr_Age" />
                <span>Homeland&nbsp;&nbsp;</span>
                <input type="text" name="attr_Homeland" />
                <span>Caste&nbsp;&nbsp;</span>
                <input type="text" name="attr_Caste" />
                <span>Trait&nbsp;&nbsp;</span>
                <input type="text" name="attr_Trait" />
                <span>Archetype&nbsp;&nbsp;</span>
                <input type="text" name="attr_Archtype" />
                <span>Nature&nbsp;&nbsp;</span>
                <input type="text" name="attr_Nature" />
                <span>Education&nbsp;&nbsp;</span>
                <input type="text" name="attr_Education" />
                <span>Appearance&nbsp;&nbsp;</span>
                <input type="text" name="attr_Appearance" />
                <span>Personality&nbsp;&nbsp;</span>
                <input type="text" name="attr_Personality1" />
                <span>Languages&nbsp;&nbsp;</span>
                <input class="col-span-2-3" type="text" name="attr_Languages" />
                <span>War Story&nbsp;&nbsp;</span>
                <textarea class="col-span-2-3" name="attr_War_Story"></textarea>
                <!--
                <textarea class="col-span-2-3" name="attr_War_Story"></textarea>
                <div contentEditable="true" class="col-span-2-3 char-ws-div" name="attr_War_Story"></div>
                -->
            </div>
            <div class="separator1"></div>
            <div class="char-points">
                <div style="text-align: center; font-size: .75em; font-weight: 800;">
                    <button style="float: left;">-</button>
                    <span>FORTUNE POINTS</span>
                    <button style="float: right;">+</button>
                </div>            
                <span>RENOWN</span>
                <span>STANDING</span>
                <span>XP Total / Spent</span>
                <input type="text" name="attr_Fortune">
                <input type="text" name="attr_Renown" />
                <input type="text" name="attr_Standing" />
                <div style="text-align: center;min-width: 100px;">
                    <input style="width:45px;" type="text" name="attr_ExperienceTotal"> / <input style="width:45px;" type="text" name="attr_Experiencespent" />
                </div>            
            </div>
        </div>

        <div class="area-talents">
            <div class="talents-banner">Talents</div>
            <fieldset class="repeating_talents">
                <div class="talents-grid">
                    <div class="field-border-narrow talents-grid-label">Base</div>
                    <select class="input-field-narrow" name="attr_talent_base" title="Talent Base">
                        <option value="Homeland" selected>Homeland</option>
                        <option value="Caste A">Caste A</option>
                        <option value="Caste B">Caste B</option>
                        <option value="Bloodline">Bloodline</option>
                        <option value="Education">Education</option>
                        <option value="Nature">Nature</option>
                        <option value="Archtype">Archtype</option>
                        <option value="Other">Other</option>
                        <option value="Agility">Agility</option>
                        <option value="Awareness">Awareness</option>
                        <option value="Brawn">Brawn</option>
                        <option value="Coordination">Coordination</option>
                        <option value="Intelligence">Intelligence</option>
                        <option value="Personality">Personality</option>
                        <option value="Willpower">Willpower</option>
                    </select>
                    <div class="field-border-narrow talents-grid-label">Name</div>
                    <input class="input-field-medium" type="text" name="attr_talent_name" value="" />
                    <div class="field-border-narrow talents-grid-label">Rank</div>
                    <input class="input-field-narrow" type="text" name="attr_talent_rank" />
                    <div class="field-border-narrow talents-grid-label">Skill</div>
                    <select class="input-field-medium" name="attr_talent_skill" title="Talent Skill">
                        <option value="Agility" selected>Agility</option>
                        <option value="Acrobatics">Acrobatics</option>
                        <option value="Melee">Melee</option>
                        <option value="Stealth">Stealth</option>
                        <option value="Awareness">Awareness</option>
                        <option value="Insight">Insight</option>
                        <option value="Observation">Observation</option>
                        <option value="Survival">Survival</option>
                        <option value="Stealth">Stealth</option>
                        <option value="Thievery">Thievery</option>
                        <option value="Brawn">Brawn</option>
                        <option value="Athletics">Athletics</option>
                        <option value="Resistance">Resistance</option>
                        <option value="Coordination">Coordination</option>
                        <option value="Parry">Parry</option>
                        <option value="Ranged Weapons">Ranged Weapons</option>
                        <option value="Sailing">Sailing</option>
                        <option value="Intelligence">Intelligence</option>
                        <option value="Alchemy">Alchemy</option>
                        <option value="Craft">Craft</option>
                        <option value="Healing">Healing</option>
                        <option value="Linguistics">Linguistics</option>
                        <option value="Lore">Lore</option>
                        <option value="Warfare">Warfare</option>
                        <option value="Personality">Personality</option>
                        <option value="Animal Handling">Animal Handling</option>
                        <option value="Command">Command</option>
                        <option value="Counsel">Counsel</option>
                        <option value="Persuade">Persuade</option>
                        <option value="Society">Society</option>
                        <option value="Willpower">Willpower</option>
                        <option value="Discipline">Discipline</option>
                        <option value="Sorcery">Sorcery</option>
                    </select>
                    <div></div>
                    <div class="talents-grid-button-container">
                        <button type='roll' name='roll_skill' 
                            value='&{template:talent} {{name=@{talent_name}}} {{character_name=@{character_name}}} {{base=@{talent_base}}} {{skill=@{talent_skill}}} {{rank=@{talent_rank}}} {{qualities=@{talent_qualities}}}'>
                        </button>
                    </div>
                    <div class="field-border-narrow talents-grid-label">Effect</div>
                    <input class="input-field-wide sheet-col-span-2-9" type="text" name="attr_talent_qualities" value="" />
                </div>
            </fieldset>
        </div>

        <div class="area-magic">
            <div class="magic-banner">Magic</div>
            <fieldset class="repeating_magic">
                <div class="magic-list-grid">
                    <div class="field-border-medium magic-list-hdr">Spell</div>
                    <div class="field-border-medium magic-list-hdr">Difficulty</div>
                    <div class="field-border-medium magic-list-hdr">Duration</div>
                    <div class="field-border-medium magic-list-hdr">Cost Learn/Cast</div>
                    <div class="field-border-medium magic-list-hdr">Momentum</div>
                    <input class="input-field-medium" type="text" name="attr_Magic_Name" />
                    <input class="input-field-medium" type="text" name="attr_Magic_Difficulty" />
                    <input class="input-field-medium" type="text" name="attr_Magic_Duration" />
                    <input class="input-field-medium" type="text" name="attr_Magic_Costrep1" />
                    <input class="input-field-medium" type="text" name="attr_Magic_Momentum" />
                    <div class="col-span-1-5 magic-notes-group">
                        <div class="field-border-medium magic-effects-group">
                            <div>Effects/Notes</div>
                            <button>Cast</button>
                        </div>
                        <textarea name="attr_Magic_Other_Notes"></textarea>
                    </div>
                </div>
            </fieldset>
        </div>

    </div>

    <div class="area-right-content">

        <div class="area-attr-skills">
            <img class="attrib-skills-background-top" src="https://github.com/Riccarr/roll20-character-sheets/raw/master/Conan_2d20_Adventures_In_An_Age_Undreamed_Of/img/attrib_skills_background_top.png"> 
            <div class="attrib-skills-background-bottom">
                <div class="attrib-skills-banner">Attributes & Skills</div>
                <div class="attrib-skills-fields-background">
                    <div class="attrib-skills-attrib-row">
                        <div class="attrib-skills-attrib-name">AGILITY</div>
                        <div class="field-border-narrow">
                            <input type="text" name="attr_Agility" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_agility'
                                value='&{template:skill} {{skill_name=Unskilled Agility}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Agility}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Agility}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Acrobatics</div>
                        <input class="field-border-narrow" type="text" name="attr_Acrobatics_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Acrobatics_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Acrobatics_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_acrobatics'
                                value='&{template:skill} {{skill_name=Acrobatics}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Acrobatics_Focus}cf20<@{Acrobatics_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Acrobatics_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Melee</div>
                        <input class="field-border-narrow" type="text" name="attr_Melee_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Melee_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Melee_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_melee'
                                value='&{template:skill} {{skill_name=Melee}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Melee_Focus}cf20<@{Melee_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Melee_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Stealth</div>
                        <input class="field-border-narrow" type="text" name="attr_Stealth_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Stealth_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Stealth_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Stealth'
                                value='&{template:skill} {{skill_name=Stealth}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Stealth_Focus}cf20<@{Stealth_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Stealth_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <span class="attrib-skills-attrib-name">AWARENESS</span>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Awareness" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_awareness'
                                    value='&{template:skill} {{skill_name=Unskilled Awareness}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Awareness}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Awareness}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Insight</div>
                        <input class="field-border-narrow" type="text" name="attr_Insight_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Insight_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Insight_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Insight'
                                value='&{template:skill} {{skill_name=Insight}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Insight_Focus}cf20<@{Insight_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Insight_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Observation</div>
                        <input class="field-border-narrow" type="text" name="attr_Observation_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Observation_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Observation_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Observation'
                                value='&{template:skill} {{skill_name=Observation}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Observation_Focus}cf20<@{Observation_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Observation_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Survival</div>
                        <input class="field-border-narrow" type="text" name="attr_Survival_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Survival_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Survival_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Survival'
                                value='&{template:skill} {{skill_name=Survival}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Survival_Focus}cf20<@{Survival_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Survival_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Thievery</div>
                        <input class="field-border-narrow" type="text" name="attr_Thievery_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Thievery_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Thievery_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Thievery'
                                value='&{template:skill} {{skill_name=Thievery}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Thievery_Focus}cf20<@{Thievery_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Thievery_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <span class="attrib-skills-attrib-name">BRAWN</span>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Brawn" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_Brawn'
                                    value='&{template:skill} {{skill_name=Unskilled Brawn}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Brawn}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Brawn}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Athletics</div>
                        <input class="field-border-narrow" type="text" name="attr_Athletics_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Athletics_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Athletics_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Athletics'
                                value='&{template:skill} {{skill_name=Athletics}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Athletics_Focus}cf20<@{Athletics_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Athletics_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Resistance</div>
                        <input class="field-border-narrow" type="text" name="attr_Resistance_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Resistance_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Resistance_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Resistance'
                                value='&{template:skill} {{skill_name=Resistance}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Resistance_Focus}cf20<@{Resistance_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Resistance_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <div class="attrib-skills-attrib-name">COORDINATION</div>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Coordination" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_coordination'
                                    value='&{template:skill} {{skill_name=Unskilled Coordination}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Coordination}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Coordination}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Parry</div>
                        <input class="field-border-narrow" type="text" name="attr_Parry_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Parry_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Parry_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Parry'
                                value='&{template:skill} {{skill_name=Parry}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Parry_Focus}cf20<@{Parry_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Parry_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Ranged/W</div>
                        <input class="field-border-narrow" type="text" name="attr_Ranged_Weapon_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Ranged_Weapon_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Ranged_Weapon_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Ranged_Weapon'
                                value='&{template:skill} {{skill_name=Ranged_Weapon}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Ranged_Weapon_Focus}cf20<@{Ranged_Weapon_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Ranged_Weapon_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Sailing</div>
                        <input class="field-border-narrow" type="text" name="attr_Sailing_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Sailing_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Sailing_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Sailing'
                                value='&{template:skill} {{skill_name=Sailing}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Sailing_Focus}cf20<@{Sailing_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Sailing_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <div class="attrib-skills-attrib-name">INTELLIGENCE</div>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Intelligence" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_intelligence'
                                    value='&{template:skill} {{skill_name=Unskilled Intelligence}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Intelligence}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Intelligence}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Alchemy</div>
                        <input class="field-border-narrow" type="text" name="attr_Alchemy_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Alchemy_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Alchemy_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Alchemy'
                                value='&{template:skill} {{skill_name=Alchemy}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Alchemy_Focus}cf20<@{Alchemy_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Alchemy_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Craft</div>
                        <input class="field-border-narrow" type="text" name="attr_Craft_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Craft_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Craft_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Craft'
                                value='&{template:skill} {{skill_name=Craft}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Craft_Focus}cf20<@{Craft_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Craft_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Healing</div>
                        <input class="field-border-narrow" type="text" name="attr_Healing_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Healing_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Healing_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Healing'
                                value='&{template:skill} {{skill_name=Healing}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Healing_Focus}cf20<@{Healing_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Healing_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Linguistics</div>
                        <input class="field-border-narrow" type="text" name="attr_Linguistics_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Linguistics_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Linguistics_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Linguistics'
                                value='&{template:skill} {{skill_name=Linguistics}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Linguistics_Focus}cf20<@{Linguistics_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Linguistics_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Lore</div>
                        <input class="field-border-narrow" type="text" name="attr_Lore_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Lore_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Lore_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Lore'
                                value='&{template:skill} {{skill_name=Lore}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Lore_Focus}cf20<@{Lore_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Lore_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Warfare</div>
                        <input class="field-border-narrow" type="text" name="attr_Warfare_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Warfare_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Warfare_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Warefare'
                                value='&{template:skill} {{skill_name=Warefare}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Warefare_Focus}cf20<@{Warefare_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Warefare_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <span class="attrib-skills-attrib-name">PERSONALITY</span>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Personality" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_personality'
                                    value='&{template:skill} {{skill_name=Unskilled Personality}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Personality}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Personality}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-medium">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Animal/H</div>
                        <input class="field-border-narrow" type="text" name="attr_Animal_Handling_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Animal_Handling_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Animal_Handling_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Animal_Handling'
                                value='&{template:skill} {{skill_name=Animal_Handling}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Animal_Handling_Focus}cf20<@{Animal_Handling_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Animal_Handling_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Command</div>
                        <input class="field-border-narrow" type="text" name="attr_Command_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Command_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Command_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Command'
                                value='&{template:skill} {{skill_name=Command}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Command_Focus}cf20<@{Command_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Command_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Counsel</div>
                        <input class="field-border-narrow" type="text" name="attr_Counsel_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Counsel_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Counsel_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Counsel'
                                value='&{template:skill} {{skill_name=Counsel}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Counsel_Focus}cf20<@{Counsel_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Counsel_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Persuade</div>
                        <input class="field-border-narrow" type="text" name="attr_Persuade_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Persuade_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Persuade_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Persuade'
                                value='&{template:skill} {{skill_name=Persuade}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Persuade_Focus}cf20<@{Persuade_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Persuade_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Society</div>
                        <input class="field-border-narrow" type="text" name="attr_Society_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Society_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Society_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Society'
                                value='&{template:skill} {{skill_name=Society}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Society_Focus}cf20<@{Society_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Society_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-separator"></div>
                    <div class="attrib-skills-attrib-row">
                        <div class="attrib-skills-attrib-name">WILLPOWER</div>
                        <div class="field-border-narrow attrib-skills-attrib-value">
                            <input type="text" name="attr_Willpower" value="0" />
                        </div>
                        <div class="field-border-narrow attrib-skills-attrib-row-button-container">
                            <button type='roll' name='roll_willpower'
                                    value='&{template:skill} {{skill_name=Unskilled Willpower}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs0cf20<@{Willpower}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Willpower}}}'></button>
                        </div>
                    </div>
                    <div class="attrib-skills-header-row-grid">
                        <div class="field-border-narrow">Skill</div>
                        <div class="field-border-narrow">Exp</div>
                        <div class="field-border-narrow">Foc</div>
                        <div class="field-border-narrow">TN</div>
                        <div class="field-border-narrow">&nbsp;</div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Discipline</div>
                        <input class="field-border-narrow" type="text" name="attr_Discipline_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Discipline_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Discipline_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Discipline'
                                value='&{template:skill} {{skill_name=Discipline}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Discipline_Focus}cf20<@{Discipline_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Discipline_TN}}}'>
                            </button>
                        </div>
                    </div>
                    <div class="attrib-skills-skills-row-grid">
                        <div class="field-border-medium attrib-skills-skills-row-grid-label">Sorcery</div>
                        <input class="field-border-narrow" type="text" name="attr_Sorcery_Expertise" value="0" />
                        <input class="field-border-narrow" type="text" name="attr_Sorcery_Focus" value="0" />
                        <span class="field-border-narrow" type="text" name="attr_Sorcery_TN"></span>
                        <div class="field-border-narrow attrib-skills-skills-button-container">
                            <button type='roll' name='roll_Sorcery'
                                value='&{template:skill} {{skill_name=Sorcery}} {{character_name=@{character_name}}} {{successes=[[?{Dice|2}d20sacs<@{Sorcery_Focus}cf20<@{Sorcery_TN}]]}} {{num_dice=[[?{Dice}]]}} {{target_number=@{Sorcery_TN}}}'>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    </div>

    <div class="area-center-right-content">
        <div class="area-npc">
            <div class="npc-banner">NPC / Summoned Creatures</div>
            <fieldset class="repeating_npc">
                <div class="npc-list-grid">
                    <div class="field-border-medium npc-list-hdr">Name</div>
                    <div class="field-border-medium npc-list-hdr">Agility</div>
                    <div class="field-border-medium npc-list-hdr">Awareness</div>
                    <div class="field-border-medium npc-list-hdr">Brawn</div>
                    <div class="field-border-medium npc-list-hdr">Coordination</div>
                    <div class="field-border-medium npc-list-hdr">Intelligence</div>
                    <div class="field-border-medium npc-list-hdr">Personality</div>
                    <div class="field-border-medium npc-list-hdr">Willpower</div>
                    <div style="width: 100%;">
                        <input class="input-field-wide" style="width: 100%;" type="text" name="attr_NPCcharacter_name" />
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCAgility" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCAwareness" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCBrawn" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCCoordination" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCIntelligence" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCPersonality" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="npc-field-group">
                        <input class="input-field-medium" type="text" name="attr_NPCWillpower" value="0" />
                        <button type='roll' name='roll_skill' value='&{template:talent} {{name=@{ATallent_Namerep}}} {{character_name=@{character_name}}} {{base=@{tallentbaserep}}} {{skill=@{tallentrollrep}}} {{rank=@{ATallent_Rankrep}}} {{effect=@{ATallent_Effectrep}}}'></button>
                    </div>
                    <div class="field-border-medium npc-list-hdr" style="padding-top:10px; height: 48px;">Skills & Details</div>
                    <div class="col-span-2-7">
                        <textarea name="attr_NPC_Notes"></textarea>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="area-footer">
    </div>
</div>

<!-- TEMPLATES -->

<rolltemplate class="sheet-rolltemplate-talent">
    <div class="sheet-rolltemplate-bkgrnd">
        <div class="sheet-rolltemplate-banner">{{character_name}}'s Talent - {{name}}</div>
        <span style="color:rgb(4, 63, 2);font-weight: 800;">{{character_name}}</span>
        <span> uses talent </span>
        <span style="color: rgb(4, 63, 2);font-weight: 800;">{{name}}</span>
        <div class="sheet-rolltemplate-grid">
            <div class="sheet-rolltemplate-label">Base</div>
            <div class="sheet-rolltemplate-value">: {{base}}</div>
            <div class="sheet-rolltemplate-label">Skill</div>
            <div class="sheet-rolltemplate-value">: {{skill}}</div>
            <div class="sheet-rolltemplate-label">Rank</div>
            <div class="sheet-rolltemplate-value">: {{rank}}</div>
            <div class="sheet-rolltemplate-label">Effects</div>
            <div class="sheet-rolltemplate-value">: {{qualities}}</div>
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-skill">
    <div class="sheet-rolltemplate-bkgrnd">
        <div class="sheet-rolltemplate-banner" style="color:rgb(4, 63, 2);";>{{character_name}}'s Skill - {{skill_name}}</div>
        <p style="margin-bottom: 8px;">Rolls {{num_dice}} dice!  Target number is: <span style="font-size: 1.2em;color:red;">{{target_number}}</span></p>
        <p>Scores {{successes}} successes!</p>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-damage">
    <div class="sheet-rolltemplate-bkgrnd">
        <div class="sheet-rolltemplate-banner">{{character_name}}'s Damage</div>
        <div class="sheet-rolltemplate-grid">
            <div class="sheet-rolltemplate-label">Weapon</div>
            <div class="sheet-rolltemplate-value">: {{weaponname}}</div>
            <div class="sheet-rolltemplate-label">Range/Reach</div>
            <div class="sheet-rolltemplate-value">: {{rangereach}}</div>
            <div class="sheet-rolltemplate-label">Size</div>
            <div class="sheet-rolltemplate-value">: {{size}}</div>
            <div class="sheet-rolltemplate-label">Weapon Damage</div>
            <div class="sheet-rolltemplate-value">: {{damage}}</div>
            <div class="sheet-rolltemplate-label">Bonus Damage</div>
            <div class="sheet-rolltemplate-value">: {{bonusdamage}}</div>
            <div class="sheet-rolltemplate-label" style="margin-bottom: 8px;">Total Damage</div>
            <div class="sheet-rolltemplate-value" style="margin-bottom: 8px;">: {{totaldamage}}</div>
            <div class="sheet-rolltemplate-label" style="margin-bottom: 4px;">Area Struck</div>
            <div class="sheet-rolltemplate-value" style="margin-bottom: 4px;">: {{areastruck}}</div>
            <div class="sheet-rolltemplate-label">Qualities</div>
            <div class="sheet-rolltemplate-value">: {{qualities}}</div>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-double-trouble">
    <div class="sheet-rolltemplate-bkgrnd">
        <div class="sheet-rolltemplate-dt-banner">{{character_name}} Skill Roll - {{name}}</div>
        <span>Conan says</span>
        <span class="dt-standout">DOUBLE TROUBLE</span>
        <span> for {{character_name}}</span>
    </div>
</rolltemplate>

<script type="text/worker">

    function prePopulateSection(sectionName, minRows, fieldName) {
        getSectionIDs(sectionName, function(idArray) {
            var currentRows = idArray.length;
            for(var i = currentRows; i < minRows; i++) {
                var newrowid = generateRowID();
                var newrowattrs = {};
                newrowattrs["repeating_" + sectionName + "_" + newrowid + "_" + fieldName] = " ";
                setAttrs(newrowattrs);
            }
        });
    }
    
    
    handleChangeAttribute = function(eventInfo) {
        var attrName = eventInfo.sourceAttribute;
        console.log("Attribute changed event for " + attrName);
        getAttrs([eventInfo.sourceAttribute], function(values) {
            console.log("Attribute value:" + values[attrName]);
        });
    }
    
    updateBonusDamage = function(eventInfo) {
        var attrName = eventInfo.sourceAttribute;
        getAttrs([eventInfo.sourceAttribute], function(values) {
            attrValue = values[attrName];
            bonusValue = 0;
            if (attrValue > 0) {
                if (attrValue == 9)
                    bonusValue = 1
                if (attrValue > 9)
                    bonusValue = 2
                if (attrValue > 11)
                    bonusValue = 3
                if (attrValue > 13)
                    bonusValue = 4
                if (attrValue > 15)
                    bonusValue = 5
            }
            var newAttrValue = {};
            if (attrName == 'brawn')
                newAttrValue['weapon_damagebonus_melee'] = bonusValue;
            if (attrName == 'awareness')
                newAttrValue['weapon_damagebonus_range'] = bonusValue;
            if (attrName == 'personality')
                newAttrValue['weapon_damagebonus_presence'] = bonusValue;

            setAttrs(newAttrValue);
        });
    }
    
    updateTN = function(eventInfo) {
        var attrName = eventInfo.sourceAttribute;
        for(let item of Attribs_Skills) {
            if (attrName.indexOf(item.attrib) > -1 || attrName.indexOf(item.skill) > -1) {
                getAttrs([item.attrib, item.skill], function(values){
                    var tn = parseInt(values[item.attrib]) + parseInt(values[item.skill]);
                    var tn_attr = item.skill.replace('_expertise','_tn');
                    var new_tn = {};
                    new_tn[tn_attr] = tn;
                    setAttrs(new_tn);
                });
            }
        }
    }


    rollWeaponDamage = function(eventInfo) {
        //value="&{template:damage}  {{weaponname=@{weapon_name}}} 
        //{{totaldamage=[[(?{Modifier to Damage Dice|0}+@{weapon_Damage_rep}+@{weapon_Attribute_rep})t[Combat-Dice]]]+@{weapon_Damagebonus_rep}}} 
        //{{areastruck=[[1t[Hit-Location]]]}} " +>        
    }


    //***** CHANGE EVENTS *********************************************
    //on('change:attribute', handleChangeAttribute);
    //on('change:gender', handleChangeAttribute);
    //on('change:Gender', handleChangeAttribute);
    //on('change:repeating_weapons:weapon_Name', handleChangeAttribute);
    on('change:repeating_weapons', handleChangeAttribute);  //this fires for any weapon field in row
    on('change:repeating_belongings', handleChangeAttribute);
    on('change:repeating_talents', handleChangeAttribute);
    on('change:repeating_magic', handleChangeAttribute);
    on('change:repeating_npc', handleChangeAttribute);

    //watch for changes to Attributes and Skills
    on('change:agility', updateTN);
    on('change:acrobatics_expertise', updateTN);
    on('change:melee_expertise', updateTN);
    on('change:stealth_expertise', updateTN);
    on('change:awareness', function(eventInfo) {
        updateBonusDamage(eventInfo);
        updateTN(eventInfo);
    });
    on('change:insight_expertise', updateTN);
    on('change:observation_expertise', updateTN);
    on('change:survival_expertise', updateTN);
    on('change:thievery_expertise', updateTN);
    on('change:brawn', function(eventInfo) {
        updateBonusDamage(eventInfo);
        updateTN(eventInfo);
    });
    on('change:athletics_expertise', updateTN);
    on('change:resistance_expertise', updateTN);
    on('change:coordination', updateTN);
    on('change:parry_expertise', updateTN);
    on('change:ranged_weapon_expertise', updateTN);
    on('change:sailing_expertise', updateTN);
    on('change:intelligence', updateTN);
    on('change:alchemy_expertise', updateTN);
    on('change:craft_expertise', updateTN);
    on('change:healing_expertise', updateTN);
    on('change:linguistics_expertise', updateTN);
    on('change:lore_expertise', updateTN);
    on('change:warfare_expertise', updateTN);
    on('change:personality', function(eventInfo) {
        updateBonusDamage(eventInfo);
        updateTN(eventInfo);
    });
    on('change:animal_handling_expertise', updateTN);
    on('change:command_expertise', updateTN);
    on('change:counsel_expertise', updateTN);
    on('change:persuade_expertise', updateTN);
    on('change:society_expertise', updateTN);
    on('change:willpower', updateTN);
    on('change:discipline_expertise', updateTN);
    on('change:sorcery_expertise', updateTN);
    

    //**** CLICK EVENTS ****************************************
    on('clicked:Combat-Dice', rollWeaponDamage);



    //**** OPEN EVENT ****************************************
    on('sheet:opened',function(){
        console.log('Starting Conan sheet...');
        
        prePopulateSection("weapons", 2, "weapon_Name");
        prePopulateSection("belongings", 3, "weapon_Name");
        prePopulateSection("talents", 5, "weapon_Name");
        prePopulateSection("magic", 2, "weapon_Name");
        prePopulateSection("npc", 1, "weapon_Name");

    });


    //**** LISTS *********************************************
    const Attribs_Skills = [
        {'attrib':'agility', 'skill':'acrobatics_expertise'},
        {'attrib':'agility', 'skill':'melee_expertise'},
        {'attrib':'agility', 'skill':'stealth_expertise'},
        {'attrib':'awareness', 'skill':'insight_expertise'},
        {'attrib':'awareness', 'skill':'observation_expertise'},
        {'attrib':'awareness', 'skill':'survival_expertise'},
        {'attrib':'awareness', 'skill':'thievery_expertise'},
        {'attrib':'brawn', 'skill':'athletics_expertise'},
        {'attrib':'brawn', 'skill':'resistance_expertise'},
        {'attrib':'coordination', 'skill':'parry_expertise'},
        {'attrib':'coordination', 'skill':'ranged_weapon_expertise'},
        {'attrib':'coordination', 'skill':'sailing_expertise'},
        {'attrib':'intelligence', 'skill':'alchemy_expertise'},
        {'attrib':'intelligence', 'skill':'craft_expertise'},
        {'attrib':'intelligence', 'skill':'healing_expertise'},
        {'attrib':'intelligence', 'skill':'linguistics_expertise'},
        {'attrib':'intelligence', 'skill':'lore_expertise'},
        {'attrib':'intelligence', 'skill':'warfare_expertise'},
        {'attrib':'personality', 'skill':'animal_handling_expertise'},
        {'attrib':'personality', 'skill':'command_expertise'},
        {'attrib':'personality', 'skill':'counsel_expertise'},
        {'attrib':'personality', 'skill':'persuade_expertise'},
        {'attrib':'personality', 'skill':'society_expertise'},
        {'attrib':'willpower', 'skill':'discipline_expertise'},
        {'attrib':'willpower', 'skill':'sorcery_expertise'}
    ];
        
</script>


