<div class="main">
  <section class="skills">
    <h3>Skills</h3>
    <fieldset class="repeating_skills">
      <input name="attr_name" placeholder="Enter skill name" type="text" />
      <input max="10" min="-10" name="attr_rating" type="number" value="2" />
      <button class="btn" name="roll_SkillCheck" type="roll" value="&{template:default} {{name=@{name} @{rating}}} {{result=[[@{rating}d6+?{Modifier}]]}}"></button>
    </fieldset>
  </section>
  <section class="statuses">
    <h3>Statuses</h3>
    <fieldset class="repeating_statuses">
      <input max="10" min="-10" name="attr_rating" type="number" value="0" />
      <input name="attr_name" placeholder="Enter status name" type="text" />
    </fieldset>
  </section>
</div>

<script type="text/worker">
  function useAttr(key, cb) {
    useAttrs([key], (attrs) => {
      cb(attrs.at(0))
    })
  }

  function useAttrs(keys, cb) {
    getAttrs(keys, (attrs) => {
      cb(Object.values(attrs))
    })
  }

  on('sheet:opened', () => {
    useAttr('do_anything_added', (doAnythingAdded) => {
      if (doAnythingAdded) return

      const attrs = { do_anything_added: true }
      const id = generateRowID()
      attrs[`repeating_skills_${id}_name`] = 'Do anything'
      attrs[`repeating_skills_${id}_rating`] = 1
      setAttrs(attrs)
    })
  })
</script>
