<input class="toggle" name="attr_sheettype" type="hidden" value="0">

<input class="selector-switch gmroll" name="attr_gmrollswitch" type="checkbox" value="1">
<input class="selector-switch rollmod" name="attr_rollmodswitch" type="checkbox" value="1">

<input class="selector-switch force" name="attr_forceswitch" type="checkbox" value="1">
<input class="selector-switch background" name="attr_backgroundswitch" type="checkbox" value="1">
<input class="selector-switch equipment" name="attr_equipmentswitch" type="checkbox" value="1">
<input checked="checked" class="selector-switch cptracker" name="attr_cpswitch" type="checkbox" value="1">
<input checked="checked" class="selector-switch credittracker" name="attr_creditswitch" type="checkbox" value="1">


<div class="master-container">

  <!-- The "Settings Menu" Cog Icon -->
  <input class="main-options options-flag" name="attr_options-flag" type="checkbox"><span style="float:left">y</span>

  <!-- Shows which sheet type is selected -->
  <div class="main-settings" style="height:1em;text-align:right;float:right;"><h2>Settings</h2></div>
  <div class="main-container pc right" style="position:absolute;right: 5px;top:-35px"><h2>Player Sheet</h2></div>
  <div class="main-container npc right" style="position:absolute;right: 5px;top:-35px"><h2>NPC Sheet</h2></div>
  <div class="main-container ship right" style="position:absolute;right: 5px;top:-35px"><h2>Ship</h2></div>
  <div class="main-container shop-inventory right" style="position:absolute;right: 5px;top:-35px"><h2>Shop/Container</h2></div>

  <div style="position:absolute;right: 5px;top:30px"><p class="version"></p></div>

  <!--  LOGO and dice images -->
  <div style="display:inline-block;position:absolute;left: 150px;padding-bottom:50px">
    <img alt="logo"
         src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/D6StarWars/logo.png" style="max-height: 80px;" title="This is where the fun begins."/>
  </div>

  <!-- ---------------------------------------------- SETTINGS MENU ------------------------------------------------- -->

  <div class="main-settings container" style="padding-top:67px">
    <div class="section" style="width:850px">

      <!-- Sheet type -->
      <div class="input-row top-row bold">
        <span
            title="Shows a more dense statblock for NPCs. Equipment sections uses the first field from the PC version">Sheet type: </span>
        <select name="attr_sheettype" style="width:90px;">
          <option selected="selected" value="0">PC</option>
          <option value="1">NPC</option>
          <option value="2">Ship</option>
          <option value="3">Container</option>
        </select>
      </div>

      <!-- GM roll toggle -->
      <div class="input-row top-row bold">
        <span title="Hides the GM rolls. They are like regular rolls but whispered to the GM">Hide GM Rolls?</span>
        <input name="attr_gmrollswitch" type="checkbox" value="1">
      </div>

      <!-- dice roll toggle -->
      <div class="input-row top-row bold">
        <span title="If checked, rolls don't ask for roll modifiers and rolls right away when selected.">Disable roll modification query when rolling?</span>
        <input name="attr_rollmodswitch" type="checkbox" value="1">
      </div>

      <!-- Wild Die toggle -->
      <div class="input-row top-row bold">
        <span title="If Wild Die isn't used, the die rolls wont explode or highlight critical successes nor failures">Use Wild Die in rolls?</span>
        <select name="attr_wilddie" style="width: 70px;">
          <option selected="selected" value="!cf1cs6">Yes</option>
          <option value="cf0cs0">No</option>
        </select>
      </div>

      <!-- Few optional sections to hide -->
      <div class="input-row top-row bold">
        <span title="Useful for those who are not Force-sensitive">Hide/Show Sections:</span>
      </div>
      <div class="input-row top-row bold">
        <span title="Useful for those who are not Force-sensitive">Hide Force Section? <input name="attr_forceswitch"
                                                                                              type="checkbox" value="1"></span>
      </div>
      <div class="input-row top-row bold">
        <span>Hide Equipment Section? </span>
        <input name="attr_equipmentswitch" type="checkbox" value="1">
      </div>
      <div class="input-row top-row bold">
        <span>Hide Background Section? </span>
        <input name="attr_backgroundswitch" type="checkbox" value="1">
      </div>
      <div class="input-row top-row bold">
        <span>Hide Character Point Summary Section? </span>
        <input checked="checked" name="attr_cpswitch" type="checkbox" value="1">
      </div>
      <div class="input-row top-row bold">
        <span>Hide Credit Summary Section? </span>
        <input checked="checked" name="attr_creditswitch" type="checkbox" value="1">
      </div>
    </div>
  </div>

  <!--  ---------------------------------------------- MAIN SHEET --------------------------------------------------- -->

  <div class="main-container container" style="padding-top:75px">

    <!-- --------------------------------------------- Player Core info -------------------------------------------- -->

    <div class="section pc">
      <div class="2colrow">
        <div class="col" style="display:inline-block;">
          <label class="toppad">Character Name <input class="right shorttext" name="attr_charactername" style="width:60%"
                                                      type="text"/></label>
          <label class="toppad">Type <input class="right shorttext" name="attr_type" style="width:60%"
                                            type="text"/></label>
          <label class="toppad">Species <input class="right shorttext" name="attr_species" style="width:60%;"
                                               type="text"/></label>

          <div class="physical-params">
            <label class="toppad">Age <input class="smalltext shorttext" name="attr_age" type="text"/></label>
            <label class="toppad">Height <input class="smalltext shorttext" name="attr_height" type="text"/></label>
            <label class="toppad">Weight <input class="smalltext shorttext" name="attr_weight" type="text"/></label>
            <label class="toppad">Gender <input class="mediumtext shorttext" name="attr_gender" type="text"/></label>
          </div>
        </div>
        <div class="col">
          <label>Physical Description
            <textarea name="attr_Physical_Description" style="height:6em; width:97%; margin-top: 3px;"></textarea>
          </label>
          <label>Credits <input class="credits" min="0" name="attr_credits" style="width: 60%; float: right; text-align: right;"
                                type="number"/></label>
        </div>
      </div>
    </div>

    <!-- ------------------------------------------- Player Secondary Info ----------------------------------------- -->

    <div class="section pc">
      <div class='3colrow'>
        <div class='col'>
          <label class="areaLabel">Special Abilities</label>
          <textarea name="attr_specialAbilities" style="width:95%;height:12em"></textarea>
        </div>
        <div class='col'>
          <label>Move <input class="smallshortnumber" min="0" name="attr_move" type="number" value="10"/></label>
          <label>Force Sensitive?
            <select class="smallselect" name="attr_forceSensitive">
              <option value="1">Yes</option>
              <option selected="selected" value="0">No</option>
            </select>
          </label>
          <label>Force Points <input class="smallshortnumber" min="0" name="attr_forcePoints" type="number" value="1"/></label>
          <!---On char creation everyone starts with 1 FP --->
          <label>Dark Side Points <input class="smallshortnumber" min="0" name="attr_darkSidePoints" type="number"
                                         value="0"/></label>
          <label>Character Points <input class="smallshortnumber" min="0" name="attr_characterPoints" type="number"
                                         value="0"/></label> <!---On char creation everyone starts with 5 CP --->
          <label style="text-decoration:underline; padding-top: 20px">Wound Level
            <select class="mediumselect left" name="attr_WoundLevel" style="width:135px">
              <option selected="selected" value="0">Healthy</option>
              <option value="1">Stunned</option>
              <option value="1">Wounded</option>
              <option value="2">Wounded Twice</option>
              <option value="5">Incapacitated</option>
              <!-- You shouldn't even be able to make checks while incapacitated or Mortally wounded, hence -5. -->
              <option value="5">Mortally Wounded</option>
            </select>
          </label>
        </div>
        <div class='col'>
          <table class="custom-roll-table">
            <tr>
              <th style="vertical-align: top;">Initiative bonus</th>
              <td colspan="2" style="padding-left: 6px; padding-bottom: 40px"><input class="smallnumber shortnumber"
                                                                                     min="0"
                                                                                     name="attr_initiative"
                                                                                     type="number" value="0"/>D+<input
                  class="pipnumber shortnumber" max="2" min="0" name="attr_initiativepip" type="number" value="0"/></td>
            </tr>
            <tr></tr>
            <tr>
              <th>Initiative</th>
              <td></td>
              <td>
                <button class="d6-dice rollmod" name="roll_init" type="roll"
                        value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie} &{tracker}]]}}"></button>
                <button class="d6-dice rollmod-no" name="roll_initnomod" type="roll"
                        value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + 1d6@{wilddie} &{tracker}]]}}"></button>
              </td>
            </tr>
            <tr>
              <th>Custom Roll</th>
              <td>
                <button class="d6-dice gmroll-hide" name="roll_customroll-w" type="roll"
                        value="/w gm &{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}">
                  <span class="redtxt">(GM)</span></button>
              </td>
              <td>
                <button class="d6-dice" name="roll_customroll" type="roll"
                        value="&{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}"></button>
              </td>
            </tr>
            <tr>
              <th>Extra Dice</th>
              <td>
                <button class="d6-dice gmroll-hide" name="roll_extraroll-w" type="roll"
                        value="/w gm &{template:black} {{name=Extra Dice}} {{Roll=[[{?{Number of  extra dice|0}d6cf0cs7}]]}}">
                  <span class="redtxt">(GM)</span></button>
              </td>
              <td>
                <button class="d6-dice" name="roll_extraroll" type="roll"
                        value="&{template:black} {{name=Extra Dice}} {{Roll=[[{?{Number of  extra dice|0}d6cf0cs7}]]}}"></button>
              </td>
            </tr>
            <tr>
              <th>Character points roll</th>
              <td>
                <button class="d6-dice gmroll-hide" name="roll_charptroll-w" type="roll"
                        value="/w gm &{template:black} {{name=Character points roll}} {{Roll=[[?{Number of char points to spend on roll|1|2|3|4|5}d6!cf0cs6]]}}">
                  <span class="redtxt">(GM)</span></button>
              </td>
              <td>
                <button class="d6-dice" name="roll_charptroll" type="roll"
                        value="&{template:black} {{name=Character points roll}} {{Roll=[[?{Number of char points to spend on roll|1|2|3|4|5}d6!cf0cs6]]}}"></button>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <!-- ---------------------------------------------- NPC info block --------------------------------------------- -->

    <div class="section npc">
      <div class="2colrow">
        <div class="col" style="display:inline-block;">
          <label class="toppad">NPC Name <input class="right shorttext" name="attr_charactername" style="width:65%"
                                                type="text"></label>
          <label style="text-decoration:underline;">Wound Level
            <select class="mediumselect left" name="attr_WoundLevel" style="width:135px">
              <option selected="selected" value="0">Healthy</option>
              <option value="1">Stunned</option>
              <option value="1">Wounded</option>
              <option value="2">Wounded Twice</option>
              <option value="5">Incapacitated</option>
              <!--You shouldn't even be able to make checks while incapacitated or Mortally wounded, hence -15. Later will include option to ignore wound penalties -->
              <option value="5">Mortally Wounded</option>
            </select>
          </label>
          <label>Initiative bonus<input class="smallnumber shortnumber" min="0" name="attr_initiative" type="number"
                                        value="0">D+<input class="pipnumber shortnumber" max="2"
                                                           min="0" name="attr_initiativepip" type="number"
                                                           value="0"></label>
          <button class="d6-dice rollmod-no" name="roll_init_n" type="roll"
                  value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + 1d6@{wilddie} &{tracker}]]}}">
            Initiative
          </button>

          <button class="d6-dice rollmod" name="roll_init_n" type="roll"
                  value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie} &{tracker}]]}}">
            Initiative
          </button>
          <button class="d6-dice" name="roll_customroll_n" type="roll"
                  value="&{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}">
            Custom Roll(no mods)
          </button>
          <button class="d6-dice gmroll-hide" name="roll_customroll_n-w" type="roll"
                  value="/w gm &{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}">
            <span class="redtxt">(GM)</span>C Roll
          </button>
        </div>
        <div class="col">
          <label>Physical Description & Other Info</label>
          <textarea name="attr_Physical_Description" style="height:6em;width:97%"></textarea>
        </div>
      </div>
    </div>

    <div class="section shop-inventory">
      <label><input name="attr_containername" type="text"></label>
    </div>

    <!-- --------------------------------------------- Attributes&Skills ------------------------------------------- -->

    <div class="section pc npc">
      <div class="flex-box">
        <div class="flex-col">

          <!---Dex Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="roll_dex" type="roll"
                      value="&{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexteritypip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                Dexterity
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_dex-w" type="roll"
                      value="/w gm &{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexteritypip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_dex_n" type="roll"
                      value="&{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexteritypip} + 1d6@{wilddie}]]}}">
                Dexterity
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_dex_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexteritypip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_dexterity" type="number" value="3"/>D+<input class="pipnumber"
                                                                                                           max="2"
                                                                                                           min="0"
                                                                                                           name="attr_dexteritypip"
                                                                                                           type="number"
                                                                                                           value="0"/>
              </div>
            </div>
            <fieldset class="repeating_dexskills"> <!---Dex Skills --->
              <button class="d6-dice rollmod" name="roll_dexskill" type="roll"
                      value="&{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_dexskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_dexskill_n" type="roll"
                      value="&{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexskillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_dexskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexskillpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_dexskillname" type="text"/>
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_dexskilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_dexskillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>

          <!---Know Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="knwo" type="roll"
                      value="&{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowledgepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                Knowledge
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="know-w" type="roll"
                      value="/w gm &{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowledgepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="know_n" type="roll"
                      value="&{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowledgepip} + 1d6@{wilddie}]]}}">
                Knowledge
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="know_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowledgepip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_knowledge" type="number" value="3"/>D+<input class="pipnumber"
                                                                                                           max="2"
                                                                                                           min="0"
                                                                                                           name="attr_knowledgepip"
                                                                                                           type="number"
                                                                                                           value="0"/>
              </div>
            </div>
            <fieldset class="repeating_knowskills">  <!---Know Skills --->
              <button class="d6-dice rollmod" name="knowskill" type="roll"
                      value="&{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="knoskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="knowskill_n" type="roll"
                      value="&{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowskillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="knowskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowskillpip}+ 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_knowskillname" type="text"/>
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_knowskilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_knowskillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>

          <!---Mech Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="roll_mech" type="roll"
                      value="&{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechanicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                Mechanical
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_mech-w" type="roll"
                      value="/w gm &{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechanicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_mech_n" type="roll"
                      value="&{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechanicalpip} + 1d6@{wilddie}]]}}">
                Mechanical
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_mech_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechanicalpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_mechanical" type="number" value="3"/>D+<input
                  class="pipnumber" max="2" min="0" name="attr_mechanicalpip" type="number" value="0"/>
              </div>
            </div>
            <fieldset class="repeating_mechskills">  <!---Mech Skills --->
              <button class="d6-dice rollmod" name="roll_mechskill" type="roll"
                      value="&{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_mechskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_mechskill_n" type="roll"
                      value="&{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up}-1)d6cf0cs7 + @{mechskillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_mechskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechskillpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_mechskillname" type="text"/>
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_mechskilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_mechskillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>
        </div>


        <div class="flex-col">

          <!---Perc Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="roll_per" type="roll"
                      value="&{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs7 +@{perceptionpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
                Perception
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_per-w" type="roll"
                      value="/w gm &{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs7 +@{perceptionpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_per_n" type="roll"
                      value="&{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 +@{perceptionpip} +1d6@{wilddie}]]}}">
                Perception
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_per_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 +@{perceptionpip} +1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_perception" type="number" value="3"/>D+<input
                  class="pipnumber" max="2" min="0" name="attr_perceptionpip" type="number" value="0"/>
              </div>
            </div>
            <fieldset class="repeating_perckills"> <!---Perc Skills --->
              <button class="d6-dice rollmod" name="roll_perskill" type="roll"
                      value="&{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perckillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_perskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perckillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_perskill_n" type="roll"
                      value="&{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{perckillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_perskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{perckillpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_perckillname" type="text"/>
              <!-- Misspelled attr name iis to be left as it is, otherwise it wipes char sheets from perseption skills-->
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_perckilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_perckillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>

          <!---Str Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="roll_str" type="roll"
                      value="&{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strengthpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                Strength
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_str-w" type="roll"
                      value="/w gm &{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strengthpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_str_n" type="roll"
                      value="&{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strengthpip} + 1d6@{wilddie}]]}}">
                Strength
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_str_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strengthpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_strength" type="number" value="3"/>D+<input class="pipnumber"
                                                                                                          max="2"
                                                                                                          min="0"
                                                                                                          name="attr_strengthpip"
                                                                                                          type="number"
                                                                                                          value="0"/>
              </div>
            </div>
            <fieldset class="repeating_strskills"> <!---Str Skills --->
              <button class="d6-dice rollmod" name="roll_strskill" type="roll"
                      value="&{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_strskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_strskill_n" type="roll"
                      value="&{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up}-1)d6cf0cs7 + @{strskillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_strskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strskillpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_strskillname" type="text"/>
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_strskilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_strskillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>

          <!---Tech Attribute --->

          <div class="tdborder">
            <div class="bold">
              <button class="d6-dice rollmod" name="roll_tech" type="roll"
                      value="&{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{technicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                Technical
              </button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_tech-w" type="roll"
                      value="/w gm &{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{technicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_tech_n" type="roll"
                      value="&{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{technicalpip} + 1d6@{wilddie}]]}}">
                Technical
              </button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_tech_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{technicalpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <div style="float:right;">
                <input class="smallnumber" min="1" name="attr_technical" type="number" value="3"/>D+<input class="pipnumber"
                                                                                                           max="2"
                                                                                                           min="0"
                                                                                                           name="attr_technicalpip"
                                                                                                           type="number"
                                                                                                           value="0"/>
              </div>
            </div>
            <fieldset class="repeating_techskills">  <!---Tech Skills --->
              <button class="d6-dice rollmod" name="roll_techskill" type="roll"
                      value="&{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{techskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_techskill-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{techskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>

              <button class="d6-dice rollmod-no" name="roll_techskill_n" type="roll"
                      value="&{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{techskillpip} + 1d6@{wilddie}]]}}"></button>
              <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_techskill_n-w" type="roll"
                      value="/w gm &{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{techskillpip} + 1d6@{wilddie}]]}}">
                <span class="redtxt">GM</span></button>
              <input class="skilltext" name="attr_techskillname" type="text"/>
              <div class="right">
                <input class="smallnumber shortnumber" min="1" name="attr_techskilldice" type="number"
                       value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0" name="attr_techskillpip"
                                           type="number" value="0"/>
              </div>
            </fieldset>
          </div>
        </div>
      </div>  <!-- flexbox-->
    </div>

    <!-- ---------------------------------------------- Weapons & Armor -------------------------------------------- -->

    <div class="section pc npc shop-inventory">
      <label style="text-align: center">Weapon & Armor</label>
      <table>
        <tr>
          <td style="width:210px"><label>Weapon</label></td>
          <td style="width:70px">Skill Roll</td>
          <td style="width:72px">Damage</td>
          <td style="width:45px">Short</td>
          <td style="width:50px">Med</td>
          <td style="width:45px">Long</td>
          <td style="width:35px">ROF</td>
          <td style="width:30px;text-align:center;">Ammo</td>
        </tr>
      </table>
      <fieldset class="repeating_weapons">
        <input class="skilltext" name="attr_weapon" style="width:200px" type="text"/>
        <input class="smallnumber" min="1" name="attr_weaponskill" type="number" value="1"/>D+<input class="pipnumber"
                                                                                                     max="2"
                                                                                                     min="0"
                                                                                                     name="attr_weaponskillpip" type="number"
                                                                                                     value="0"/>
        <input class="smallnumber shortnumber" min="1" name="attr_damagedice" type="number" value="1"/>D+<input
          class="pipnumber shortnumber" max="2" min="0" name="attr_damagepip" type="number" value="0"/>
        <input class="smallnumber shortnumber" name="attr_shortrange" type="number"/>
        <input class="mediumnumber shortnumber" name="attr_medrange" type="number"/>
        <input class="mediumnumber shortnumber" name="attr_longrange" type="number"/>
        <input class="smallnumber shortnumber" name="attr_ROF" type="number"/>
        <input class="mediumnumber shortnumber" name="attr_Ammo" type="number"/>
        <!-- roll buttons with roll queries -->
        <button class="d6-dice rollmod" name="roll_attack" type="roll"
                value="&{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs0 + @{weaponskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
          Atk
        </button>
        <button class="d6-dice rollmod-no" name="roll_attack" type="roll"
                value="&{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{weaponskillpip} + 1d6@{wilddie}]]}}">
          Atk
        </button>


        <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_attack-w" type="roll"
                value="/w gm &{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs0 + @{weaponskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>Atk
        </button>
        <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_attack-w" type="roll"
                value="/w gm &{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{weaponskillpip} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>Atk
        </button>

        <button class="d6-dice" name="roll_dmg" type="roll"
                value="&{template:red} {{name=@{weapon} damage}} {{Roll=[[(@{damagedice}- 1)d6cf0cs7 + @{damagepip} + (1d6@{wilddie})]]}}">
          Dmg
        </button>
        <button class="d6-dice gmroll gmroll-hide" name="roll_dmg-w" type="roll"
                value="/w gm &{template:red} {{name=@{weapon} damage}} {{Roll=[[(@{damagedice}- 1)d6cf0cs7 + @{damagepip} + (1d6@{wilddie})]]}}">
          <span class="redtxt">GM</span>Dmg
        </button>
      </fieldset>
      <table>
        <tr>
          <td style="width:200px"><label>Armor</label></td>
          <td style="width:80px">Physical</td>
          <td style="width:80px">Energy</td>
          <td style="width:180px">Other</td>
          <td style="width:180px">Damage Soak Rolls</td>
        </tr>
      </table>
      <fieldset class="repeating_armors">
        <input class="skilltext" name="attr_armorname" style="width:200px" type="text"/>
        <input class="smallnumber shortnumber" min="0" name="attr_armorPhDice" type="number" value="1"/>D+<input
          class="pipnumber shortnumber" max="2" min="0" name="attr_armorPhPip" type="number" value="0"/>
        <input class="smallnumber shortnumber" min="0" name="attr_armorEnDice" type="number" value="1"/>D+<input
          class="pipnumber shortnumber" max="2" min="0" name="attr_armorEnPip" type="number" value="0"/>
        <input class="skilltext" name="attr_armor_other" type="text"/>
        <button class="d6-dice rollmod-no physical" name="roll_dmg_soak_en" type="roll"
                value="&{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +1d6@{wilddie}]]}}">
          t
        </button>
        <button class="d6-dice rollmod-no energy" name="roll_dmg_soak_ph" type="roll"
                value="&{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} -1)d6cf0cs0 +@{strengthpip} +@{armorEnPip} +1d6@{wilddie}]]}}">
          e
        </button>
        <button class="d6-dice rollmod-no" name="roll_dmg_soak_str" type="roll"
                value="&{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} -1)d6cf0cs0 +@{strengthpip} +1d6@{wilddie}]]}}">
          Str only
        </button>

        <button class="d6-dice rollmod-no gmroll physical gmroll-hide" name="roll_dmg_soak_en-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} -1)d6cf0cs0 +@{strengthpip} + @{armorPhPip} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>t
        </button>
        <button class="d6-dice rollmod-no gmroll energy gmroll-hide" name="roll_dmg_soak_ph-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} -1)d6cf0cs0 +@{strengthpip} + @{armorEnPip} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>e
        </button>
        <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_dmg_soak_str-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} -1)d6cf0cs0 +@{strengthpip} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>S
        </button>

        <button class="d6-dice rollmod physical" name="roll_dmg_soak_en" type="roll"
                value="&{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
          t
        </button>
        <button class="d6-dice rollmod energy" name="roll_dmg_soak_ph" type="roll"
                value="&{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorEnPip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
          e
        </button>
        <button class="d6-dice rollmod" name="roll_dmg_soak_str" type="roll"
                value="&{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
          Str only
        </button>

        <button class="d6-dice rollmod-no gmroll physical gmroll-hide" name="roll_dmg_soak_en-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>t
        </button>
        <button class="d6-dice rollmod-no gmroll energy gmroll-hide" name="roll_dmg_soak_ph-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} +?{Dice mods|0} -1)d6cf0cs0  +@{strengthpip} +@{armorEnPip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>e
        </button>
        <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_dmg_soak_str-w" type="roll"
                value="/w gm &{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">
          <span class="redtxt">GM</span>S
        </button>
      </fieldset>
    </div>

    <!-- ----------------------------------------------- Force Section --------------------------------------------- -->

    <div class="section force-hide pc npc">
      <label style="text-align: center">Force Section</label>
      <div class='3colrow'>
        <div class='col'>
          <table style="width:280px">
            <caption>Force Skills</caption>
            <tr><!--Control -->
              <td class="tdborder">
                <div class="bold">
                  <button class="d6-dice rollmod forcebutton" name="roll_force_control" type='roll'
                          value='&{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    Control
                  </button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_control" type='roll'
                          value='/w gm &{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no forcebutton" name="roll_force_control" type='roll'
                          value='&{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod}  +1d6@{wilddie}]]}}'>
                    Control
                  </button>
                  <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_force_control-w" type='roll'
                          value='/w gm &{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>
                  <div class="bold" style="float:right;">
                    <input class="smallnumber" min="0" name="attr_control" type="number" value="0"/>D+<input
                      class="pipnumber" max="2" min="0" name="attr_controlpip" type="number" value="0"/>
                  </div>
                </div>
                <fieldset class="repeating_controlpowers">  <!---Control Powers --->
                  <button class="d6-dice rollmod" name="roll_force_control_p" type="roll"
                          value="&{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_force_control_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no" name="roll_force_control_p" type="roll"
                          value="&{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_force_control_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>
                  <input class="skilltext" name="attr_controlpowername" type="text"/>
                </fieldset>
              </td>
            </tr>
            <tr><!-- Sense -->
              <td class="tdborder">
                <div class="bold">
                  <button class="d6-dice rollmod forcebutton" name="roll_force_sense" type='roll'
                          value='&{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    Sense
                  </button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_force_sense-w" type='roll'
                          value='/w gm &{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no forcebutton" name="roll_force_sense" type='roll'
                          value='&{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>
                    Sense
                  </button>
                  <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_force_sense-w" type='roll'
                          value='/w gm &{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>
                  <div class="bold" style="float:right;">
                    <input class="smallnumber" min="0" name="attr_sense" style="margin-left: 100px;" type="number"
                           value="0"/>D+<input class="pipnumber" max="2" min="0" name="attr_sensepip" type="number"
                                               value="0"/>
                  </div>
                </div>
                <fieldset class="repeating_sensepowers">  <!---Sense Powers --->
                  <button class="d6-dice rollmod" name="roll_force_sense_p" type="roll"
                          value="&{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_force_sense_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no" name="roll_force_sense_p" type="roll"
                          value="&{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_force_sense_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>
                  <input class="skilltext" name="attr_sensepowername" type="text"/>
                </fieldset>
              </td>
            </tr>
            <tr><!-- Alter -->
              <td class="tdborder">
                <div class="bold">
                  <button class="d6-dice rollmod forcebutton" name="roll_force_alter" type='roll'
                          value='&{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    Alter
                  </button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_force_alter-w" type='roll'
                          value='/w gm &{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no forcebutton" name="roll_force_alter" type='roll'
                          value='&{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up}-1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>
                    Alter
                  </button>
                  <button class="d6-dice rollmod-no  gmroll gmroll-hide" name="roll_force_alter-w" type='roll'
                          value='/w gm &{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up}-1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>
                    <span class="redtxt">GM</span></button>
                  <div class="bold" style="float:right;">
                    <input class="smallnumber" min="0" name="attr_alter" type="number" value="0"/>D+<input class="pipnumber"
                                                                                                           max="2"
                                                                                                           min="0"
                                                                                                           name="attr_alterpip"
                                                                                                           type="number"
                                                                                                           value="0"/>
                  </div>
                </div>
                <fieldset class="repeating_alterpowers">  <!---Alter Powers --->
                  <button class="d6-dice rollmod" name="roll_force_alter_p" type="roll"
                          value="&{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 + @{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod gmroll gmroll-hide" name="roll_force_alter_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>

                  <button class="d6-dice rollmod-no" name="roll_force_alter_p" type="roll"
                          value="&{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
                  <button class="d6-dice rollmod-no gmroll gmroll-hide" name="roll_force_alter_p-w" type="roll"
                          value="/w gm &{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}">
                    <span class="redtxt">GM</span></button>
                  <input class="skilltext" name="attr_alterpowername" type="text"/>
                </fieldset>
              </td>
            </tr>
          </table>
        </div>
        <div class='col'><!-- Force Power Trackers -->
          <table style="position:relative;left:30px">
            <caption>Force Powers Active</caption>
            <tr>
              <td><!---Force Emptiness --->
                <span style="padding-top:8px; padding-bottom:12px;"
                      title="Force Emptiness adds +6 pips to all force skill rolls when active. Bonus is reduced by 1 for every DSP">Force Emptiness active</span>
                <!---Force Emptiness adds +6 pips to all force skill rolls when active --->
                <select class="smallselect" name="attr_Force_Emptiness">
                  <option selected="selected" value="false">No</option>
                  <option value="true">Yes</option>
                </select>
              </td>
            </tr>
            <tr>
              <td><!---Force Powers active --->
                <span>Resist Pain active
                  <!---Reduces Wound penalties to -1. Doesn't need to be counted on the tracker below --->
								<select class="smallselect" name="attr_PainResist"
                        title="Reduces Wound penalties to -1. Doesn't need to be counted on the tracker below">
								  <option selected="selected" value="false">No</option>
								  <option value="true">Yes</option>
								</select>
							</span>
              </td>
            </tr>
            <tr>
              <td><!---Force Powers active --->
                <span># of other powers active<!---gives penalty to all rolls thanks to concentration/distraction --->
								<select class="smallselect" name="attr_Force_Up"
                        title="The number of power active is subtracted from all roll as a Multiple Action Penalty. Above Force Pain doesn't need to be added">
								  <option selected="selected" value="0">0</option>
								  <option value="-1">1</option>
								  <option value="-2">2</option>
								  <option value="-3">3</option>
								  <option value="-4">4</option>
								  <option value="-5">5</option>
								</select>
							</span>
              </td>
            </tr>
          </table>
        </div>
        <div class='col'><!-- Force Power list -->
          <label style="padding-top:8px; padding-bottom:12px;">Force Powers</label>
          <textarea name="attr_forcePowers" style="width:95%;height:24em"></textarea>
        </div>
      </div>
      <br>
      <br>
      <div class='col'>
					<span style="padding-top:8px; padding-bottom:12px;">Lightsaber Combat
						<input class="skilltext" name="attr_lightsaberskill" type="text" value="lightsaber"/>
						<input class="smallnumber shortnumber" min="1" name="attr_lightsaberskilldice" type="number"
                   value="3"/>D+<input class="pipnumber shortnumber" max="2" min="0"
                                       name="attr_lightsaberskillpip" type="number" value="0"/>
						<button class="d6-dice rollmod" name="roll_lc_attack" type="roll"
                    value="&{template:default} {{name=@{lightsaberskill}}} {{Roll=[[(@{lightsaberskilldice} -@{WoundMod} +@{Force_Up} +@{sense} +?{Dice mods|0} -1)d6cf0cs0 + @{lightsaberskillpip} +@{Force_EmptinessMod} +@{sensepip} +?{Other Mods(pip)|0} +(1d6@{wilddie})]]}}">LC Attack</button>
						<button class="d6-dice rollmod-no" name="roll_lc_attack" type="roll"
                    value="&{template:default} {{name=@{lightsaberskill}}} {{Roll=[[(@{lightsaberskilldice} -@{WoundMod} +@{Force_Up} +@{sense} -1)d6cf0cs0 + @{lightsaberskillpip} +@{Force_EmptinessMod} +@{sensepip} +(1d6@{wilddie})]]}}">LC Attack</button>
						<input class="smallnumber shortnumber" min="1" name="attr_lightsaberdamagedice" type="number"
                   value="6"/>D+<input class="pipnumber shortnumber" max="2" min="0"
                                       name="attr_lightsaberdamagepip" type="number" value="0"/>
						<button class="d6-dice rollmod" name="roll_lc_dmg" type="roll"
                    value="&{template:default} {{name=@{lightsaberskill} damage}} {{Roll=[[(@{lightsaberdamagedice} +?{Dice mods|0} -1)d6cf0cs0  +@{lightsaberdamagepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +(1d6@{wilddie})]]}}">LC Damage</button>
						<button class="d6-dice rollmod-no" name="roll_lc_dmg" type="roll"
                    value="&{template:default} {{name=@{lightsaberskill} damage}} {{Roll=[[(@{lightsaberdamagedice}- 1)d6cf0cs0 +@{lightsaberdamagepip} +@{Force_EmptinessMod} +(1d6@{wilddie})]]}}">LC Damage</button>
					</span>
      </div>
    </div>

    <!-- ------------------------------------------------ Equipment PC --------------------------------------------- -->

    <div class="section equipment-hide pc shop-inventory">
      <label style="text-align: center;">Equipment</label>
      <table style="width:97%">
        <tr>
          <td style="text-align: right;">
            <textarea name="attr_geartext1"></textarea>
            <textarea name="attr_geartext2"></textarea>
          </td>
          <td style="text-align: center;">
            <textarea name="attr_geartext3"></textarea>
            <textarea name="attr_geartext4"></textarea>
          </td>
          <td style="text-align: Left;">
            <textarea name="attr_geartext5"></textarea>
            <textarea name="attr_geartext6"></textarea>
          </td>
        </tr>
      </table>
    </div>

    <!-- ------------------------------------------------ Equipment NPC -------------------------------------------- -->

    <div class="section equipment-hide npc">
      <label style="text-align: center">Equipment</label>
      <textarea name="attr_geartext1" style="height:7em;width:96%"></textarea>
    </div>

    <!-- ------------------------------------------- Background & extended info ------------------------------------- -->

    <div class="section background-hide pc npc">
      <label style="text-align: center">Background and extended info</label>
      <table>
        <tr>
          <td style="width:33.33%;"><label>Background</label>
            <div>
              <textarea name="attr_background"></textarea>
            </div>
          </td>
          <td style="width:33.33%;">
            <label>Personality</label>
            <div>
              <textarea name="attr_personality"></textarea>
            </div>
          </td>
          <td style="width:33.33%;">
            <label>Objectives</label>
            <div>
              <textarea name="attr_objectives"></textarea>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <label>Quotes</label>
            <div>
              <textarea name="attr_quotes"></textarea>
            </div>
          </td>
          <td>
            <label>Connections to other characters</label>
            <div>
              <textarea name="attr_connections"></textarea>
            </div>
          </td>
          <td>
            <label>Additional Notes</label>
            <div>
              <textarea name="attr_notes"></textarea>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <!-- ---------------------------------------------Character Point tracking ------------------------------------- -->

    <div class="section cptracker-hide pc">
      <label>Character Point Tracker</label>
      <span class="bold">Character Point Balance:</span>
      <span class="num" name="attr_cp_spent"></span>
      <fieldset class="repeating_cptable">
        <div style="padding-top: 8px;">
          <input name="attr_cp_desc" style="width:80%;" type="text">
          <input name="attr_cp_amount" type="number">
        </div>
      </fieldset>
    </div>

    <!-- ------------------------------------------------- Credit tracking ----------------------------------------- -->

    <div class="section credittracker-hide pc">
      <label>Credit Tracker</label>
      <span class="bold">Credit Balance:</span>
      <span class="num credits" name="attr_credit_spent"></span>
      <fieldset class="repeating_credittable">
        <div style="padding-top: 8px;">
          <input name="attr_credit_desc" style="width:80%;" type="text">
          <input name="attr_credit_amount" style="width:100px;" type="number">
        </div>
      </fieldset>
    </div>

    <!-- ------------------------------------------------- Ship Core info ------------------------------------------ -->

    <div class="section ship shipheader">
      <span class="bold">Starship:<input name="attr_ship_name" type="text"></span>
      <span class="bold">Scale:<input name="attr_ship_scale" type="text"></span>
      <span class="bold">Length:<input name="attr_ship_length" type="text"></span>
    </div>

    <div class="section ship shipblock">
      <div class="price wborder">
        <label>Pricing:</label>
        <label>Introduction Era</label>
        <div class="priceblock wborder">
          <div class="flex-row">
            <span>Era</span>
            <input name="attr_intro_era_name" type="text">
          </div>
          <div class="flex-row">
            <span>New</span>
            <input name="attr_intro_era_price_new" type="text">
          </div>
          <div class="flex-row">
            <span>Used</span>
            <input name="attr_intro_era_price_used" type="text">
          </div>
        </div>
        <label>Current Era:</label>
        <div class="priceblock wborder">
          <div class="flex-row">
            <span>Era</span>
            <input name="attr_current_era_name" type="text">
          </div>
          <div class="flex-row">
            <span>Reproduction</span>
            <input name="attr_current_era_reproduction" type="text">
          </div>
          <div class="flex-row">
            <span>New-Old-Stock</span>
            <input name="attr_current_era_new_old" type="text">
          </div>
          <div class="flex-row">
            <span>Restored</span>
            <input name="attr_current_era_price_restored" type="text">
          </div>
          <div class="flex-row">
            <span>Used</span>
            <input name="attr_current_era_price_used" type="text">
          </div>
        </div>
      </div>

      <div class="perf wborder">
        <label class="title">Performance</label>
        <div class="perf-block">
          <div class="flex-col wborder" style="margin-right: 7px;">
            <label style="width:80px;">Crew Station:</label>
            <input class="medium" name="attr_crew_station_performance" type="text">
          </div>
          <div class="flex-col">
            <label>Maneuverability:</label>
            <input class="medium" name="attr_maneuverability" type="text">
          </div>
          <div class="flex-col">
            <label>Move(Space Units)</label>
            <input class="medium" name="attr_ship_space" type="text">
          </div>
          <div class="flex-col">
            <label>Move(Ground units)</label>
            <input class="medium" name="attr_ship_ground" type="text">
          </div>
          <div class="flex-col">
            <label>Speed(Athmospheric)</label>
            <input class="medium" name="attr_ship_athmosphere" type="text">
          </div>
        </div>
      </div>

      <div class="sensor wborder">
        <label>Sensors</label>
        <div class="flex-row">
          <div class="wborder">
            <label>Crew Station</label>
            <input class="medium" name="attr_crew_station_sensors" type="text">
          </div>
          <div class="grid">
            <div></div><!-- empty placeholder in the grid-->
            <span>Search</span>
            <span>Scan</span>
            <span>Passive</span>
            <span>Focus</span>

            <span>Range</span>
            <input class="smallnumber" name="attr_sensor_search" type="number"/>
            <input class="smallnumber" name="attr_sensor_scan" type="number"/>
            <input class="smallnumber" name="attr_sensor_passive" type="number"/>
            <input class="smallnumber" name="attr_sensor_focus" type="number"/>

            <span>Sensitivity</span>
            <input class="smallnumber" name="attr_sensor_search_max" type="number"/>
            <input class="smallnumber" name="attr_sensor_scan_max" type="number"/>
            <input class="smallnumber" name="attr_sensor_passive_max" type="number"/>
            <input class="smallnumber" name="attr_sensor_focus_max" type="number"/>
          </div>
        </div>
      </div>

      <div class="hyperdrive wborder">
        <label>Hyperdrive System</label>
        <div class="wborder">
          <div class="wborder crew">
            <label>Crew Station</label>
            <input class="medium" name="attr_crew_station_hyperdrive" type="text">
          </div>
          <div class="hyper-grid">
            <label>Astrogation System</label>
            <label>Hyperdrive Integration</label>
            <label>Hyperdrive Rating</label>

            <input name="attr_astrogation_system" type="text">
            <input name="attr_hyperdrive_integration" type="text">
            <input name="attr_hyperdrive_rating" type="text">

            <label>Astromech</label>
            <label>Jump Route Capacity</label>
            <label>Kilo-Parsecs / Hour</label>

            <input name="attr_astromech" type="text">
            <input name="attr_jump_capacity" type="text">
            <input name="attr_parsec_speed" type="text">
          </div>
        </div>

      </div>

      <div class="consume wborder">
        <div>
          <label>Consumables:</label>
          <input name="attr_ship_consumables" type="text">
        </div>

        <div>
          <label>Max:</label>
          <input name="attr_ship_consumables_max" type="text">
        </div>
      </div>

      <div class="dura wborder">
        <label>Durability:</label>
        <label>Hull:</label>
        <label>Shields:</label>
        <div>
          <input name="attr_ship_durability" type="text">
        </div>
        <div>
          <input name="attr_ship_hull" type="text">
        </div>
        <div>
          <input name="attr_ship_shields" type="text">
        </div>
      </div>
    </div>

    <!-- --------------------------------------------------- Ship Weapons ------------------------------------------ -->

    <div class="section ship">
      <label>Ship Weapons</label>
      <fieldset class="repeating_shipweapon">
        <label class="bold">Weapon Name<input name="attr_weapon_name" type="text"></label>
        <div style="margin-bottom:10px;">
          <span>Scale:<input class="smallnumber" name="attr_weapon_scale" type="text" value=""></span>
          <span>Fire Arc:<input name="attr_weapon_arc" type="text" value=""></span>
          <span>Crew:<input name="attr_weapon_crew" type="text" value=""></span>
        </div>

        <div style="margin-bottom:10px;">
          <span>Skill:<input name="attr_weapon_skill" type="text" value=""></span>
          <span>Fire Control:<input class="smallnumber" name="attr_weapon_fire_control" type="number" value=""> D</span>
          <span style="margin-left: 15px;">Space Range:<input class="mediumnumber" name="attr_weapon_range_space" type="number"
                                                              value=""></span>
          <span>Atmosphere Range:<input class="smallnumber" name="attr_weapon_range_atmosphere" type="number" value=""></span>
        </div>

        <div style="margin-bottom:10px;">
          <span>Damage:<input class="smallnumber" name="attr_weapon_damage" type="number" value="3">D+<input
              class="smallnumber" name="attr_weapon_damage_pip" type="number" value="0"> <button class="d6-dice"
                                                                                                 name="roll_ship_wpn_dmg"
                                                                                                 type="roll"
                                                                                                 value="&{template:swd6} {{name=Weapon: @{weapon_name} }} {{subtitle=Ship: @{ship_name} }} {{Roll=[[(@{weapon_damage}- 1)d6cf0cs0 + @{weapon_damage_pip} +(1d6@{wilddie})]] damage}}">DMG</button></span>
        </div>

      </fieldset>
    </div>

    <!-- ------------------------------------------------- Unused ship stats --------------------------------------- -->

    <div class="section ship">
      <label>Other stats</label>
      <div class="other">
        <span class="bold">Craft:<input name="attr_ship_craft" type="text"></span>
        <span class="bold">Type:<input name="attr_ship_type" type="text"></span>
        <span class="bold">Crew:<input class="mediumnumber" name="attr_ship_crew" type="number"></span>
      </div>
      <div class="other">
        <span class="bold">Skill:<input name="attr_ship_skill" type="text"></span>
        <span class="bold">Passangers:<input class="mediumnumber" name="attr_ship_passangers" type="number"></span>
        <span class="bold">Cargo Capacity:<input name="attr_ship_cargo_capacity" type="text"></span>
      </div>
      <div class="other">
        <span class="bold">Hyperdrive Multipiler:<input name="attr_hyperdrive_multi" style="width:90px;"
                                                        type="text"></span>
        <span class="bold">Hyperdrive Backup:<input name="attr_hyperdrive_backup" type="text"></span>
        <span class="bold">Nav Computer:<input name="attr_nav_computer" type="text"></span>
      </div>
    </div>

    <!-- -----------------------------------------------Generic Ship&Vehicle section ------------------------------- -->

    <div class="section ship">
      <div class='2colrow'>
        <div class='col'><!-- Vehicle -->
          <label style="padding-top:4px;padding-bottom:4px;">Vehicle</label>
          <input class="skilltext" name="attr_vehiclename" style="width:95%;padding-bottom:8px;" type="text"/>
          <textarea name="attr_vehicle" style="width:97%;height:17em;"></textarea>
        </div>
        <div class='col'><!-- Starship -->
          <label style="padding-top:4px;padding-bottom:4px;">Starship</label>
          <input class="skilltext" name="attr_starshipname" style="width:95%;padding-bottom:8px;" type="text"/>
          <textarea name="attr_starship" style="width:97%;height:17em;"></textarea>
        </div>
      </div>
    </div>

    <!-- ------------------------------------------------------- Footer -------------------------------------------- -->

    <div class="section" style="text-align: Center; padding-top:10px;">
      <p class="version" style="text-align: center;"><small>Original Author: Timothy O'Driscoll | Main Editor: Andreas
        J. (Roll20user: 1223200) | </small></p>
    </div>

  </div>
</div>

<!-- -------------------------------Hidden Values----------------@{WoundLevel} +@{Pain}----------------------------- -->

<input name="attr_Force_EmptinessMod" type="hidden" value="0">
<input name="attr_WoundMod" type="hidden" value="0">

<!------------------------------------------------------- ROLL TEMPLATES ------------------------------------------- -->
<!-- new template -->

<rolltemplate class="sheet-rolltemplate-swd6">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
      {{#name}}
      <div class="sheet-name">{{name}}</div>
      {{/name}}
      {{#subtitle}}
      <div class="sheet-subtitle">{{subtitle}}</div>
      {{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color}}
      {{#desc}}
      <div class="sheet-desc">{{desc}}</div>
      {{/desc}}
    </div>
  </div>
</rolltemplate>

<!-- old -->

<rolltemplate class="sheet-rolltemplate-blue">
  <table>
    <caption>{{name}}</caption>
    {{#allprops() }}
    <tr>
      <td>{{key}}</td>
      <td>{{value}}</td>
      {{/allprops() }}
  </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-green">
  <table>
    <caption>{{name}}</caption>
    {{#allprops() }}
    <tr>
      <td>{{key}}</td>
      <td>{{value}}</td>
      {{/allprops() }}
  </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-red">
  <table>
    <caption>{{name}}</caption>
    {{#allprops() }}
    <tr>
      <td>{{key}}</td>
      <td>{{value}}</td>
      {{/allprops() }}
  </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-black">
  <table>
    <caption>{{name}}</caption>
    {{#allprops() }}
    <tr>
      <td>{{key}}</td>
      <td>{{value}}</td>
      {{/allprops() }}
  </table>
</rolltemplate>

<!-- ----------------------------------------------------- Sheet workers ------------------------------------------- -->

<script type="text/worker">
/* ===== PARAMETERS ==========
destination = the name of the attribute that stores the total quantity
section = name of repeating fieldset, without the repeating_
fields = the name of the attribute field to be summed
      can be a single attribute: 'weight'
      or an array of attributes: ['weight','number','equipped']
multiplier (optional) = a multiplier to to entire fieldset total. For instance, if summing coins of weight 0.02, might want to multiply the final total by 0.02.
*/
const repeatingSum = (destination, section, fields, multiplier = 1) => {
    if (!Array.isArray(fields)) fields = [fields];
    getSectionIDs(`repeating_${section}`, idArray => {
        const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
        getAttrs(attrArray, v => {
            console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                 // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
            const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0); 
            const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
            setAttrs({[destination]: sumTotal * multiplier});    
        });
    });
};


on("change:painresist change:woundlevel", function() {
   getAttrs(["WoundLevel", "PainResist","WoundMod"], function(values) {
	if(values.WoundLevel == "0"){
		var update = {};
		update.WoundMod = "0";
		setAttrs(update);
	}
	else if(values.WoundLevel == "1"){
		var update = {};
		update.WoundMod = "1";
		setAttrs(update);
	}
	else if(values.WoundLevel == "2"){
		if(values.PainResist == "false"){
			var update = {};
			update.WoundMod = "2";
			setAttrs(update);
		}
		if(values.PainResist == "true"){
			var update = {};
			update.WoundMod = "1";
			setAttrs(update);
		}
	}
	else if(values.WoundLevel == "5"){
		if(values.PainResist == "true"){
			var update = {};
			update.WoundMod = "1";
			setAttrs(update);
		}
		if(values.PainResist == "false"){
			var update = {};
			update.WoundMod = "5";
			setAttrs(update);
		}
	}
   });
});

on("change:force_emptiness change:darksidepoints", function() {
   getAttrs(["Force_Emptiness","darkSidePoints"], function(values) {
		let v_Force_Emptiness = values.Force_Emptiness;
		let v_Force_EmptinessMod = 0;
		let v_darkSidePoints = parseInt(values.darkSidePoints)||0;

		if(v_Force_Emptiness == "true"){
			v_Force_EmptinessMod = 6 - v_darkSidePoints;
		}
		setAttrs({
			Force_EmptinessMod:v_Force_EmptinessMod
		});
   });
});

on("change:repeating_credittable remove:repeating_credittable", function() {
	repeatingSum("credit_spent","credittable","credit_amount");
});

on("change:repeating_cptable change:repeating_cptable", function() {
	repeatingSum("cp_spent", "cptable","cp_amount");
});

</script>
